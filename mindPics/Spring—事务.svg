<svg xmlns:ed="http://www.edrawsoft.cn/xml/2017/SVGExtensions/" width="4069" viewBox="0 0 4069 3474" ed:name="Page-1" xmlns="http://www.w3.org/2000/svg" ed:hSpacing="30" height="3474" id="page100" ed:vSpacing="30" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css"><![CDATA[
g[ed\:togtopicid],g[ed\:hyperlink],g[ed\:comment],g[ed\:note] {cursor:pointer;}
g[id] {-moz-user-select: none;-ms-user-select: none;user-select: none;}
svg text::selection,svg tspan::selection{background-color: #4285f4;color: #ffffff;fill: #ffffff;}
.st3 {fill:#000000;font-family:微软雅黑;font-size:9pt}
.st5 {fill:#000000}
.st6 {fill:#f96628;font-family:微软雅黑;font-size:9pt}
.st4 {fill:#ff0000;font-family:微软雅黑;font-size:9pt}
.st2 {fill:#ffffff;font-family:微软雅黑;font-size:11pt}
.st1 {fill:#ffffff;font-family:微软雅黑;font-size:14pt}
]]></style><defs><linearGradient x1="0%" y2="100%" x2="0%" y1="0%" id="lg1"><stop stop-color="#ffffff" offset="0"/><stop stop-color="#f0f5f0" offset="0.25"/><stop stop-color="#e1ebe1" offset="0.75"/><stop stop-color="#c8d7c8" offset="1"/></linearGradient></defs><rect x="0" width="4069" y="0" height="3474" fill="#ffffff"/><path stroke="#ff783c" d="M0,0C0,0,5.2,-0.1,6.6,5.5C8,11,4.7,14.5,5.9,18.9C7,23.2,12,24.3,12,24.3C12,24.3,7.1,25.1,5.9,29.6C4.6,34.1,8,37.5,6.6,43C5.2,48.5,0,48.5,0,48.5" ed:type="summary" ed:idlist="250,252" id="262" transform="matrix(1,0,0,1,697,1192)" ed:parentid="250,252" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M0,-251.1L0,251.1" ed:tosuperid="102" id="103" transform="matrix(1,0,0,1,207,327)" ed:parentid="101" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,183L3.7,183L3.7,-177C3.7,-180.3,6.4,-183,9.7,-183L13.5,-183" ed:tosuperid="104" id="105" transform="matrix(1,0,0,1,399,423)" ed:parentid="102" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,70.4L3.7,70.4L3.7,-64.4C3.7,-67.7,6.4,-70.4,9.7,-70.4L13.5,-70.4" ed:tosuperid="106" id="107" transform="matrix(1,0,0,1,695,170)" ed:parentid="104" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,56.6L3.7,-50.6C3.7,-53.9,6.4,-56.6,9.7,-56.6L13.5,-56.6" ed:tosuperid="108" id="109" transform="matrix(1,0,0,1,695,184)" ed:parentid="104" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,42.9L3.7,-36.9C3.7,-40.2,6.4,-42.9,9.7,-42.9L13.5,-42.9" ed:tosuperid="110" id="111" transform="matrix(1,0,0,1,695,197)" ed:parentid="104" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-13.8L3.7,7.8C3.7,11.1,6.4,13.8,9.7,13.8L13.5,13.8" ed:tosuperid="112" id="113" transform="matrix(1,0,0,1,695,254)" ed:parentid="104" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-70.4L3.7,64.4C3.7,67.7,6.4,70.4,9.7,70.4L13.5,70.4" ed:tosuperid="114" id="115" transform="matrix(1,0,0,1,695,311)" ed:parentid="104" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,13.8L3.7,13.8L3.7,-7.8C3.7,-11.1,6.4,-13.8,9.7,-13.8L13.5,-13.8" ed:tosuperid="116" id="117" transform="matrix(1,0,0,1,903,254)" ed:parentid="112" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-36L3.7,30C3.7,33.3,6.4,36,9.7,36L13.5,36" ed:tosuperid="118" id="119" transform="matrix(1,0,0,1,903,304)" ed:parentid="112" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,29.1L3.7,29.1L3.7,-23.1C3.7,-26.4,6.4,-29.1,9.7,-29.1L13.5,-29.1" ed:tosuperid="120" id="121" transform="matrix(1,0,0,1,1208,211)" ed:parentid="116" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,11.1L3.7,-5.1C3.7,-8.4,6.4,-11.1,9.7,-11.1L13.5,-11.1" ed:tosuperid="122" id="123" transform="matrix(1,0,0,1,1208,229)" ed:parentid="116" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="124" id="125" transform="matrix(1,0,0,1,1208,247)" ed:parentid="116" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-24.9L3.7,18.9C3.7,22.2,6.4,24.9,9.7,24.9L13.5,24.9" ed:tosuperid="126" id="127" transform="matrix(1,0,0,1,1208,265)" ed:parentid="116" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,6.9L3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="128" id="129" transform="matrix(1,0,0,1,1107,333)" ed:parentid="118" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="130" id="131" transform="matrix(1,0,0,1,1107,347)" ed:parentid="118" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,46.5L3.7,-40.5C3.7,-43.8,6.4,-46.5,9.7,-46.5L13.5,-46.5" ed:tosuperid="152" id="153" transform="matrix(1,0,0,1,399,560)" ed:parentid="102" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,27.5L3.7,27.5L3.7,-21.5C3.7,-24.8,6.4,-27.5,9.7,-27.5L13.5,-27.5" ed:tosuperid="160" id="154" transform="matrix(1,0,0,1,969,436)" ed:parentid="159" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,13.8L3.7,-7.8C3.7,-11.1,6.4,-13.8,9.7,-13.8L13.5,-13.8" ed:tosuperid="161" id="155" transform="matrix(1,0,0,1,969,450)" ed:parentid="159" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="162" id="156" transform="matrix(1,0,0,1,969,464)" ed:parentid="159" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-13.8L3.7,7.8C3.7,11.1,6.4,13.8,9.7,13.8L13.5,13.8" ed:tosuperid="163" id="157" transform="matrix(1,0,0,1,969,477)" ed:parentid="159" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-27.5L3.7,21.5C3.7,24.8,6.4,27.5,9.7,27.5L13.5,27.5" ed:tosuperid="164" id="158" transform="matrix(1,0,0,1,969,491)" ed:parentid="159" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,24.9L3.7,24.9L3.7,-18.9C3.7,-22.2,6.4,-24.9,9.7,-24.9L13.5,-24.9" ed:tosuperid="159" id="165" transform="matrix(1,0,0,1,576,488)" ed:parentid="152" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,11.1L3.7,11.1L3.7,-5.1C3.7,-8.4,6.4,-11.1,9.7,-11.1L13.5,-11.1" ed:tosuperid="183" id="178" transform="matrix(1,0,0,1,1048,557)" ed:parentid="182" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="184" id="179" transform="matrix(1,0,0,1,1048,575)" ed:parentid="182" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-27.5L3.7,21.5C3.7,24.8,6.4,27.5,9.7,27.5L13.5,27.5" ed:tosuperid="182" id="187" transform="matrix(1,0,0,1,576,541)" ed:parentid="152" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-52.4L3.7,46.4C3.7,49.7,6.4,52.4,9.7,52.4L13.5,52.4" ed:tosuperid="188" id="189" transform="matrix(1,0,0,1,576,566)" ed:parentid="152" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-40.3L3.7,34.3C3.7,37.6,6.4,40.3,9.7,40.3L13.5,40.3" ed:tosuperid="191" id="192" transform="matrix(1,0,0,1,399,647)" ed:parentid="102" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,20.6L3.7,20.6L3.7,-14.6C3.7,-17.9,6.4,-20.6,9.7,-20.6L13.5,-20.6" ed:tosuperid="193" id="194" transform="matrix(1,0,0,1,809,666)" ed:parentid="191" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="195" id="196" transform="matrix(1,0,0,1,809,680)" ed:parentid="191" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="197" id="198" transform="matrix(1,0,0,1,809,694)" ed:parentid="191" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-20.6L3.7,14.6C3.7,17.9,6.4,20.6,9.7,20.6L13.5,20.6" ed:tosuperid="199" id="200" transform="matrix(1,0,0,1,809,707)" ed:parentid="191" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-109L3.7,103C3.7,106.3,6.4,109,9.7,109L13.5,109" ed:tosuperid="201" id="202" transform="matrix(1,0,0,1,399,715)" ed:parentid="102" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-198.4L3.7,192.4C3.7,195.7,6.4,198.4,9.7,198.4L13.5,198.4" ed:tosuperid="203" id="204" transform="matrix(1,0,0,1,399,805)" ed:parentid="102" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,34.4L3.7,34.4L3.7,-28.4C3.7,-31.7,6.4,-34.4,9.7,-34.4L13.5,-34.4" ed:tosuperid="205" id="206" transform="matrix(1,0,0,1,552,790)" ed:parentid="201" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="207" id="208" transform="matrix(1,0,0,1,552,824)" ed:parentid="201" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-20.6L3.7,14.6C3.7,17.9,6.4,20.6,9.7,20.6L13.5,20.6" ed:tosuperid="209" id="210" transform="matrix(1,0,0,1,552,845)" ed:parentid="201" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,20.6L3.7,-14.6C3.7,-17.9,6.4,-20.6,9.7,-20.6L13.5,-20.6" ed:tosuperid="211" id="212" transform="matrix(1,0,0,1,552,804)" ed:parentid="201" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,6.9L3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="217" id="218" transform="matrix(1,0,0,1,884,817)" ed:parentid="207" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="219" id="220" transform="matrix(1,0,0,1,884,831)" ed:parentid="207" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-34.4L3.7,28.4C3.7,31.7,6.4,34.4,9.7,34.4L13.5,34.4" ed:tosuperid="222" id="223" transform="matrix(1,0,0,1,552,859)" ed:parentid="201" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,6.9L3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="230" id="224" transform="matrix(1,0,0,1,781,1037)" ed:parentid="227" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="231" id="225" transform="matrix(1,0,0,1,781,1051)" ed:parentid="227" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,41.3L3.7,41.3L3.7,-35.3C3.7,-38.6,6.4,-41.3,9.7,-41.3L13.5,-41.3" ed:tosuperid="226" id="233" transform="matrix(1,0,0,1,576,962)" ed:parentid="203" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-20.6L3.7,14.6C3.7,17.9,6.4,20.6,9.7,20.6L13.5,20.6" ed:tosuperid="227" id="234" transform="matrix(1,0,0,1,576,1024)" ed:parentid="203" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,13.8L3.7,-7.8C3.7,-11.1,6.4,-13.8,9.7,-13.8L13.5,-13.8" ed:tosuperid="228" id="235" transform="matrix(1,0,0,1,576,989)" ed:parentid="203" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,27.5L3.7,-21.5C3.7,-24.8,6.4,-27.5,9.7,-27.5L13.5,-27.5" ed:tosuperid="229" id="236" transform="matrix(1,0,0,1,576,976)" ed:parentid="203" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-41.3L3.7,35.3C3.7,38.6,6.4,41.3,9.7,41.3L13.5,41.3" ed:tosuperid="232" id="237" transform="matrix(1,0,0,1,576,1044)" ed:parentid="203" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="238" id="239" transform="matrix(1,0,0,1,576,1003)" ed:parentid="203" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-253.4L3.7,247.4C3.7,250.7,6.4,253.4,9.7,253.4L13.5,253.4" ed:tosuperid="240" id="241" transform="matrix(1,0,0,1,399,860)" ed:parentid="102" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M0,-269.9L0,269.9" ed:tosuperid="246" id="247" transform="matrix(1,0,0,1,207,904)" ed:parentid="101" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,20.6L3.7,20.6L3.7,-14.6C3.7,-17.9,6.4,-20.6,9.7,-20.6L13.5,-20.6" ed:tosuperid="248" id="249" transform="matrix(1,0,0,1,381,1181)" ed:parentid="246" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="250" id="251" transform="matrix(1,0,0,1,381,1202)" ed:parentid="246" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-13.8L3.7,7.8C3.7,11.1,6.4,13.8,9.7,13.8L13.5,13.8" ed:tosuperid="252" id="253" transform="matrix(1,0,0,1,381,1216)" ed:parentid="246" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-27.5L3.7,21.5C3.7,24.8,6.4,27.5,9.7,27.5L13.5,27.5" ed:tosuperid="256" id="257" transform="matrix(1,0,0,1,381,1230)" ed:parentid="246" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,6.9L3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="258" id="260" transform="matrix(1,0,0,1,711,1154)" ed:parentid="248" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="259" id="261" transform="matrix(1,0,0,1,711,1168)" ed:parentid="248" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M0,-284.6L0,284.6" ed:tosuperid="273" id="274" transform="matrix(1,0,0,1,207,1515)" ed:parentid="101" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,268.1L3.7,268.1L3.7,-262.1C3.7,-265.4,6.4,-268.1,9.7,-268.1L13.5,-268.1" ed:tosuperid="289" id="306" transform="matrix(1,0,0,1,406,1559)" ed:parentid="273" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M0,-523.4L0,523.4" ed:tosuperid="309" id="310" transform="matrix(1,0,0,1,207,2379)" ed:parentid="101" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,261.3L3.7,261.3L3.7,-255.3C3.7,-258.6,6.4,-261.3,9.7,-261.3L13.5,-261.3" ed:tosuperid="328" id="311" transform="matrix(1,0,0,1,720,1580)" ed:parentid="327" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="329" id="312" transform="matrix(1,0,0,1,720,1841)" ed:parentid="327" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,247.5L3.7,247.5L3.7,-241.5C3.7,-244.8,6.4,-247.5,9.7,-247.5L13.5,-247.5" ed:tosuperid="330" id="313" transform="matrix(1,0,0,1,1020,1594)" ed:parentid="329" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,233.8L3.7,-227.8C3.7,-231.1,6.4,-233.8,9.7,-233.8L13.5,-233.8" ed:tosuperid="331" id="314" transform="matrix(1,0,0,1,1020,1607)" ed:parentid="329" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,220L3.7,-214C3.7,-217.3,6.4,-220,9.7,-220L13.5,-220" ed:tosuperid="332" id="315" transform="matrix(1,0,0,1,1020,1621)" ed:parentid="329" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,75.6L3.7,-69.6C3.7,-72.9,6.4,-75.6,9.7,-75.6L13.5,-75.6" ed:tosuperid="333" id="316" transform="matrix(1,0,0,1,1020,1765)" ed:parentid="329" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,130.6L3.7,130.6L3.7,-124.6C3.7,-127.9,6.4,-130.6,9.7,-130.6L13.5,-130.6" ed:tosuperid="334" id="317" transform="matrix(1,0,0,1,1630,1559)" ed:parentid="333" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-68.8L3.7,62.8C3.7,66.1,6.4,68.8,9.7,68.8L13.5,68.8" ed:tosuperid="336" id="318" transform="matrix(1,0,0,1,1020,1910)" ed:parentid="329" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="337" id="319" transform="matrix(1,0,0,1,1630,1690)" ed:parentid="333" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-130.6L3.7,124.6C3.7,127.9,6.4,130.6,9.7,130.6L13.5,130.6" ed:tosuperid="343" id="324" transform="matrix(1,0,0,1,1630,1820)" ed:parentid="333" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-165L3.7,159C3.7,162.3,6.4,165,9.7,165L13.5,165" ed:tosuperid="344" id="325" transform="matrix(1,0,0,1,1020,2006)" ed:parentid="329" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-261.3L3.7,255.3C3.7,258.6,6.4,261.3,9.7,261.3L13.5,261.3" ed:tosuperid="346" id="326" transform="matrix(1,0,0,1,720,2102)" ed:parentid="327" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="327" id="347" transform="matrix(1,0,0,1,406,1834)" ed:parentid="273" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,0L3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="348" id="349" transform="matrix(1,0,0,1,758,1257)" ed:parentid="256" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,75.6L3.7,75.6L3.7,-69.6C3.7,-72.9,6.4,-75.6,9.7,-75.6L13.5,-75.6" ed:tosuperid="368" id="350" transform="matrix(1,0,0,1,1799,2082)" ed:parentid="366" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,61.9L3.7,-55.9C3.7,-59.2,6.4,-61.9,9.7,-61.9L13.5,-61.9" ed:tosuperid="369" id="351" transform="matrix(1,0,0,1,1799,2095)" ed:parentid="366" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,34.4L3.7,-28.4C3.7,-31.7,6.4,-34.4,9.7,-34.4L13.5,-34.4" ed:tosuperid="370" id="352" transform="matrix(1,0,0,1,1799,2123)" ed:parentid="366" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="371" id="353" transform="matrix(1,0,0,1,1799,2164)" ed:parentid="366" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,13.8L3.7,13.8L3.7,-7.8C3.7,-11.1,6.4,-13.8,9.7,-13.8L13.5,-13.8" ed:tosuperid="372" id="354" transform="matrix(1,0,0,1,1991,2157)" ed:parentid="371" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="373" id="355" transform="matrix(1,0,0,1,1991,2171)" ed:parentid="371" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-13.8L3.7,7.8C3.7,11.1,6.4,13.8,9.7,13.8L13.5,13.8" ed:tosuperid="374" id="356" transform="matrix(1,0,0,1,1991,2185)" ed:parentid="371" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-34.4L3.7,28.4C3.7,31.7,6.4,34.4,9.7,34.4L13.5,34.4" ed:tosuperid="375" id="357" transform="matrix(1,0,0,1,1799,2192)" ed:parentid="366" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-48.1L3.7,42.1C3.7,45.4,6.4,48.1,9.7,48.1L13.5,48.1" ed:tosuperid="376" id="358" transform="matrix(1,0,0,1,1799,2205)" ed:parentid="366" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-61.9L3.7,55.9C3.7,59.2,6.4,61.9,9.7,61.9L13.5,61.9" ed:tosuperid="377" id="359" transform="matrix(1,0,0,1,1799,2219)" ed:parentid="366" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-75.6L3.7,69.6C3.7,72.9,6.4,75.6,9.7,75.6L13.5,75.6" ed:tosuperid="378" id="360" transform="matrix(1,0,0,1,1799,2233)" ed:parentid="366" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,13.8L3.7,13.8L3.7,-7.8C3.7,-11.1,6.4,-13.8,9.7,-13.8L13.5,-13.8" ed:tosuperid="379" id="361" transform="matrix(1,0,0,1,2214,2075)" ed:parentid="370" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="380" id="362" transform="matrix(1,0,0,1,2214,2089)" ed:parentid="370" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-13.8L3.7,7.8C3.7,11.1,6.4,13.8,9.7,13.8L13.5,13.8" ed:tosuperid="381" id="363" transform="matrix(1,0,0,1,2214,2102)" ed:parentid="370" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,6.9L3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="366" id="384" transform="matrix(1,0,0,1,1618,2164)" ed:parentid="344" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-82.5L3.7,76.5C3.7,79.8,6.4,82.5,9.7,82.5L13.5,82.5" ed:tosuperid="367" id="385" transform="matrix(1,0,0,1,1618,2254)" ed:parentid="344" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,96.3L3.7,96.3L3.7,-90.3C3.7,-93.6,6.4,-96.3,9.7,-96.3L13.5,-96.3" ed:tosuperid="500" id="480" transform="matrix(1,0,0,1,2113,1580)" ed:parentid="493" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="501" id="481" transform="matrix(1,0,0,1,2113,1676)" ed:parentid="493" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-96.3L3.7,90.3C3.7,93.6,6.4,96.3,9.7,96.3L13.5,96.3" ed:tosuperid="502" id="482" transform="matrix(1,0,0,1,2113,1772)" ed:parentid="493" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,82.5L3.7,82.5L3.7,-76.5C3.7,-79.8,6.4,-82.5,9.7,-82.5L13.5,-82.5" ed:tosuperid="504" id="483" transform="matrix(1,0,0,1,2478,1594)" ed:parentid="501" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,68.8L3.7,-62.8C3.7,-66.1,6.4,-68.8,9.7,-68.8L13.5,-68.8" ed:tosuperid="506" id="485" transform="matrix(1,0,0,1,2478,1607)" ed:parentid="501" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,41.3L3.7,-35.3C3.7,-38.6,6.4,-41.3,9.7,-41.3L13.5,-41.3" ed:tosuperid="510" id="489" transform="matrix(1,0,0,1,2478,1635)" ed:parentid="501" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,27.5L3.7,-21.5C3.7,-24.8,6.4,-27.5,9.7,-27.5L13.5,-27.5" ed:tosuperid="511" id="490" transform="matrix(1,0,0,1,2478,1649)" ed:parentid="501" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-34.4L3.7,28.4C3.7,31.7,6.4,34.4,9.7,34.4L13.5,34.4" ed:tosuperid="512" id="491" transform="matrix(1,0,0,1,2478,1710)" ed:parentid="501" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,116.9L3.7,116.9L3.7,-110.9C3.7,-114.2,6.4,-116.9,9.7,-116.9L13.5,-116.9" ed:tosuperid="492" id="513" transform="matrix(1,0,0,1,1945,1573)" ed:parentid="337" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="493" id="514" transform="matrix(1,0,0,1,1945,1683)" ed:parentid="337" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-103.1L3.7,97.1C3.7,100.4,6.4,103.1,9.7,103.1L13.5,103.1" ed:tosuperid="497" id="515" transform="matrix(1,0,0,1,1945,1793)" ed:parentid="337" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-116.9L3.7,110.9C3.7,114.2,6.4,116.9,9.7,116.9L13.5,116.9" ed:tosuperid="503" id="516" transform="matrix(1,0,0,1,1945,1807)" ed:parentid="337" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,55L3.7,-49C3.7,-52.3,6.4,-55,9.7,-55L13.5,-55" ed:tosuperid="517" id="518" transform="matrix(1,0,0,1,2478,1621)" ed:parentid="501" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,48.1L3.7,48.1L3.7,-42.1C3.7,-45.4,6.4,-48.1,9.7,-48.1L13.5,-48.1" ed:tosuperid="519" id="520" transform="matrix(1,0,0,1,3133,1697)" ed:parentid="512" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="521" id="522" transform="matrix(1,0,0,1,3133,1745)" ed:parentid="512" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,34.4L3.7,34.4L3.7,-28.4C3.7,-31.7,6.4,-34.4,9.7,-34.4L13.5,-34.4" ed:tosuperid="523" id="524" transform="matrix(1,0,0,1,3395,1710)" ed:parentid="521" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,20.6L3.7,-14.6C3.7,-17.9,6.4,-20.6,9.7,-20.6L13.5,-20.6" ed:tosuperid="525" id="526" transform="matrix(1,0,0,1,3395,1724)" ed:parentid="521" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="527" id="528" transform="matrix(1,0,0,1,3395,1738)" ed:parentid="521" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="529" id="530" transform="matrix(1,0,0,1,3395,1752)" ed:parentid="521" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-20.6L3.7,14.6C3.7,17.9,6.4,20.6,9.7,20.6L13.5,20.6" ed:tosuperid="531" id="532" transform="matrix(1,0,0,1,3395,1765)" ed:parentid="521" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-34.4L3.7,28.4C3.7,31.7,6.4,34.4,9.7,34.4L13.5,34.4" ed:tosuperid="533" id="534" transform="matrix(1,0,0,1,3395,1779)" ed:parentid="521" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-48.1L3.7,42.1C3.7,45.4,6.4,48.1,9.7,48.1L13.5,48.1" ed:tosuperid="535" id="536" transform="matrix(1,0,0,1,3133,1793)" ed:parentid="512" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,261.3L3.7,261.3L3.7,-255.3C3.7,-258.6,6.4,-261.3,9.7,-261.3L13.5,-261.3" ed:tosuperid="555" id="538" transform="matrix(1,0,0,1,622,2659)" ed:parentid="554" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,247.5L3.7,-241.5C3.7,-244.8,6.4,-247.5,9.7,-247.5L13.5,-247.5" ed:tosuperid="556" id="539" transform="matrix(1,0,0,1,622,2673)" ed:parentid="554" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,233.8L3.7,-227.8C3.7,-231.1,6.4,-233.8,9.7,-233.8L13.5,-233.8" ed:tosuperid="558" id="541" transform="matrix(1,0,0,1,622,2686)" ed:parentid="554" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,185.6L3.7,-179.6C3.7,-182.9,6.4,-185.6,9.7,-185.6L13.5,-185.6" ed:tosuperid="559" id="542" transform="matrix(1,0,0,1,622,2734)" ed:parentid="554" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,20.6L3.7,20.6L3.7,-14.6C3.7,-17.9,6.4,-20.6,9.7,-20.6L13.5,-20.6" ed:tosuperid="560" id="543" transform="matrix(1,0,0,1,1575,2528)" ed:parentid="567" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="561" id="544" transform="matrix(1,0,0,1,1575,2542)" ed:parentid="567" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-34.4L3.7,28.4C3.7,31.7,6.4,34.4,9.7,34.4L13.5,34.4" ed:tosuperid="562" id="545" transform="matrix(1,0,0,1,1016,2583)" ed:parentid="559" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,137.5L3.7,-131.5C3.7,-134.8,6.4,-137.5,9.7,-137.5L13.5,-137.5" ed:tosuperid="564" id="547" transform="matrix(1,0,0,1,622,2783)" ed:parentid="554" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-61.9L3.7,55.9C3.7,59.2,6.4,61.9,9.7,61.9L13.5,61.9" ed:tosuperid="565" id="548" transform="matrix(1,0,0,1,622,2982)" ed:parentid="554" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,34.4L3.7,34.4L3.7,-28.4C3.7,-31.7,6.4,-34.4,9.7,-34.4L13.5,-34.4" ed:tosuperid="566" id="549" transform="matrix(1,0,0,1,1016,2514)" ed:parentid="559" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="567" id="550" transform="matrix(1,0,0,1,1016,2549)" ed:parentid="559" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="568" id="551" transform="matrix(1,0,0,1,1575,2556)" ed:parentid="567" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-20.6L3.7,14.6C3.7,17.9,6.4,20.6,9.7,20.6L13.5,20.6" ed:tosuperid="569" id="552" transform="matrix(1,0,0,1,1575,2569)" ed:parentid="567" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-261.3L3.7,255.3C3.7,258.6,6.4,261.3,9.7,261.3L13.5,261.3" ed:tosuperid="570" id="553" transform="matrix(1,0,0,1,622,3181)" ed:parentid="554" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,0L3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="554" id="571" transform="matrix(1,0,0,1,401,2920)" ed:parentid="309" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,185.6L3.7,185.6L3.7,-179.6C3.7,-182.9,6.4,-185.6,9.7,-185.6L13.5,-185.6" ed:tosuperid="575" id="576" transform="matrix(1,0,0,1,1185,2858)" ed:parentid="565" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,171.9L3.7,-165.9C3.7,-169.2,6.4,-171.9,9.7,-171.9L13.5,-171.9" ed:tosuperid="577" id="578" transform="matrix(1,0,0,1,1185,2872)" ed:parentid="565" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-13.8L3.7,7.8C3.7,11.1,6.4,13.8,9.7,13.8L13.5,13.8" ed:tosuperid="579" id="580" transform="matrix(1,0,0,1,1185,3058)" ed:parentid="565" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,6.9L3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="585" id="586" transform="matrix(1,0,0,1,1598,3064)" ed:parentid="579" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-171.9L3.7,165.9C3.7,169.2,6.4,171.9,9.7,171.9L13.5,171.9" ed:tosuperid="587" id="588" transform="matrix(1,0,0,1,1598,3243)" ed:parentid="579" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,48.1L3.7,48.1L3.7,-42.1C3.7,-45.4,6.4,-48.1,9.7,-48.1L13.5,-48.1" ed:tosuperid="591" id="592" transform="matrix(1,0,0,1,1704,3009)" ed:parentid="585" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-82.5L3.7,76.5C3.7,79.8,6.4,82.5,9.7,82.5L13.5,82.5" ed:tosuperid="593" id="594" transform="matrix(1,0,0,1,1704,3140)" ed:parentid="585" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-103.1L3.7,97.1C3.7,100.4,6.4,103.1,9.7,103.1L13.5,103.1" ed:tosuperid="595" id="596" transform="matrix(1,0,0,1,1704,3161)" ed:parentid="585" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-123.8L3.7,117.8C3.7,121.1,6.4,123.8,9.7,123.8L13.5,123.8" ed:tosuperid="597" id="598" transform="matrix(1,0,0,1,1704,3181)" ed:parentid="585" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-151.3L3.7,145.3C3.7,148.6,6.4,151.3,9.7,151.3L13.5,151.3" ed:tosuperid="599" id="600" transform="matrix(1,0,0,1,1704,3209)" ed:parentid="585" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,116.9L3.7,116.9L3.7,-110.9C3.7,-114.2,6.4,-116.9,9.7,-116.9L13.5,-116.9" ed:tosuperid="601" id="602" transform="matrix(1,0,0,1,2117,2844)" ed:parentid="591" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="603" id="604" transform="matrix(1,0,0,1,2117,2961)" ed:parentid="591" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-116.9L3.7,110.9C3.7,114.2,6.4,116.9,9.7,116.9L13.5,116.9" ed:tosuperid="605" id="606" transform="matrix(1,0,0,1,2117,3078)" ed:parentid="591" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,6.9L3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="607" id="608" transform="matrix(1,0,0,1,1990,3257)" ed:parentid="595" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="609" id="610" transform="matrix(1,0,0,1,1990,3271)" ed:parentid="595" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,89.4L3.7,89.4L3.7,-83.4C3.7,-86.7,6.4,-89.4,9.7,-89.4L13.5,-89.4" ed:tosuperid="613" id="614" transform="matrix(1,0,0,1,2351,2872)" ed:parentid="603" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,27.5L3.7,-21.5C3.7,-24.8,6.4,-27.5,9.7,-27.5L13.5,-27.5" ed:tosuperid="617" id="618" transform="matrix(1,0,0,1,2351,2934)" ed:parentid="603" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-20.6L3.7,14.6C3.7,17.9,6.4,20.6,9.7,20.6L13.5,20.6" ed:tosuperid="619" id="620" transform="matrix(1,0,0,1,2351,2982)" ed:parentid="603" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-68.8L3.7,62.8C3.7,66.1,6.4,68.8,9.7,68.8L13.5,68.8" ed:tosuperid="621" id="622" transform="matrix(1,0,0,1,2351,3030)" ed:parentid="603" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,13.8L3.7,13.8L3.7,-7.8C3.7,-11.1,6.4,-13.8,9.7,-13.8L13.5,-13.8" ed:tosuperid="625" id="626" transform="matrix(1,0,0,1,2454,2769)" ed:parentid="613" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="627" id="628" transform="matrix(1,0,0,1,2454,2783)" ed:parentid="613" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-13.8L3.7,7.8C3.7,11.1,6.4,13.8,9.7,13.8L13.5,13.8" ed:tosuperid="629" id="630" transform="matrix(1,0,0,1,2454,2796)" ed:parentid="613" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,6.9L3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="631" id="632" transform="matrix(1,0,0,1,3138,2899)" ed:parentid="617" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-34.4L3.7,28.4C3.7,31.7,6.4,34.4,9.7,34.4L13.5,34.4" ed:tosuperid="633" id="634" transform="matrix(1,0,0,1,3138,2941)" ed:parentid="617" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,34.4L3.7,34.4L3.7,-28.4C3.7,-31.7,6.4,-34.4,9.7,-34.4L13.5,-34.4" ed:tosuperid="635" id="636" transform="matrix(1,0,0,1,2616,3064)" ed:parentid="621" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="637" id="638" transform="matrix(1,0,0,1,2616,3092)" ed:parentid="621" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-27.5L3.7,21.5C3.7,24.8,6.4,27.5,9.7,27.5L13.5,27.5" ed:tosuperid="639" id="640" transform="matrix(1,0,0,1,2616,3126)" ed:parentid="621" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,13.8L3.7,13.8L3.7,-7.8C3.7,-11.1,6.4,-13.8,9.7,-13.8L13.5,-13.8" ed:tosuperid="641" id="642" transform="matrix(1,0,0,1,3033,3071)" ed:parentid="637" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="643" id="644" transform="matrix(1,0,0,1,3033,3085)" ed:parentid="637" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-13.8L3.7,7.8C3.7,11.1,6.4,13.8,9.7,13.8L13.5,13.8" ed:tosuperid="645" id="646" transform="matrix(1,0,0,1,3033,3099)" ed:parentid="637" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,27.5L3.7,27.5L3.7,-21.5C3.7,-24.8,6.4,-27.5,9.7,-27.5L13.5,-27.5" ed:tosuperid="647" id="648" transform="matrix(1,0,0,1,3445,2865)" ed:parentid="631" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,13.8L3.7,-7.8C3.7,-11.1,6.4,-13.8,9.7,-13.8L13.5,-13.8" ed:tosuperid="649" id="650" transform="matrix(1,0,0,1,3445,2879)" ed:parentid="631" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="651" id="652" transform="matrix(1,0,0,1,3445,2893)" ed:parentid="631" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-13.8L3.7,7.8C3.7,11.1,6.4,13.8,9.7,13.8L13.5,13.8" ed:tosuperid="653" id="654" transform="matrix(1,0,0,1,3445,2906)" ed:parentid="631" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,6.9L3.7,6.9L3.7,-0.9C3.7,-4.2,6.4,-6.9,9.7,-6.9L13.5,-6.9" ed:tosuperid="655" id="656" transform="matrix(1,0,0,1,3062,3147)" ed:parentid="639" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-6.9L3.7,0.9C3.7,4.2,6.4,6.9,9.7,6.9L13.5,6.9" ed:tosuperid="657" id="658" transform="matrix(1,0,0,1,3062,3161)" ed:parentid="639" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M-13.5,13.8L3.7,13.8L3.7,-7.8C3.7,-11.1,6.4,-13.8,9.7,-13.8L13.5,-13.8" ed:tosuperid="661" id="662" transform="matrix(1,0,0,1,1811,3346)" ed:parentid="599" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,0C3.7,0,6.4,0,9.7,0L13.5,0" ed:tosuperid="663" id="664" transform="matrix(1,0,0,1,1811,3360)" ed:parentid="599" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-13.8L3.7,7.8C3.7,11.1,6.4,13.8,9.7,13.8L13.5,13.8" ed:tosuperid="665" id="666" transform="matrix(1,0,0,1,1811,3374)" ed:parentid="599" stroke-linejoin="round" fill="none"/><path stroke-linecap="round" stroke="#424f58" d="M3.7,-27.5L3.7,21.5C3.7,24.8,6.4,27.5,9.7,27.5L13.5,27.5" ed:tosuperid="667" id="668" transform="matrix(1,0,0,1,3445,2920)" ed:parentid="631" stroke-linejoin="round" fill="none"/><g ed:height="55" ed:width="239" ed:layout="map" ed:topictype="mainidea" id="101" transform="matrix(1,0,0,1,87,21)"><path stroke="#f26157" d="M4,0L235,0C237.2,0,239,1.8,239,4L239,51C239,53.2,237.2,55,235,55L4,55C1.8,55,0,53.2,0,51L0,4C0,1.8,1.8,0,4,0z" stroke-linejoin="round" fill="#f26157"/><text class="st1"><tspan style="white-space:pre" x="20" y="33.5">Spring—声明式事务</tspan></text><g ed:hyperlink="[&#xa;    {&#xa;        &quot;desc&quot;: &quot;Spring源码——事务&quot;,&#xa;        &quot;link&quot;: &quot;https://wangguoping.blog.csdn.net/article/details/83960279&quot;&#xa;    }&#xa;]&#xa;"><use xlink:href="#hyperlink" transform="translate(202,20)"/></g></g><symbol id="hyperlink"><image width="16" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NTJGODZDMEQ5Nzg0MTFFN0E1QkQ5MTVGMzVENEU0NjUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NTJGODZDMEM5Nzg0MTFFN0E1QkQ5MTVGMzVENEU0NjUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MjQ3NTkzRDY0Q0RBMTFFN0E1OTFFREQ1OEEwMjU2QjQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MjQ3NTkzRDc0Q0RBMTFFN0E1OTFFREQ1OEEwMjU2QjQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz56C9ycAAAC/klEQVR42oxTa0iTYRR+3m/f7mnNSyOjqZWmCEWXlegyLy0wIoJIiKQoqB/9KIruU5yioBlEGV0lf1RgdKGCDE1zK+clSQO10pU6M811ma7UzX2XXgdBJljn/Hjh5TnPOTznOQSiCBcn7L5d8+HC2+9jKn24BjsSdGZ94bNcKcdA4MfxO0QCTMhkUHlEcEopWg4mgB3hhaN5TR9PN9gcCAhUoMn+HW++/DBbDiWxxuK6bPwj2JrmT3kNVe+xZ0MUMlbNR3OPC6Y77eC8YlblEQMxFj3NmomA6Xd7FCIrwfrYUAQoWKTSt2BbHF50fkXh43em2pMb8mYk0C8KhkizvPGj/6PbOQpOBA5vWoxnHV9wq7EvuzEnPZZIFCCMHITmFIL4RUG5+1Ii8KBlAKXWHnR/HUXO/Q50D41BF6pCfde3SZwe/kIybQJJtSrNUrJ9GeF4MbmszoGwOUqEB6vw6NUAJjgBSTEh0EcGXU2NnRtxLD2aXKnrcUnpiIJUgsH4BZDojLtx3WK3XNy1kvAgyTdsfRgZ92HUy4ETRMgpsKLtc+bDlsGdDEMOnMtYRvHd1ikEdNm4VuuwXNq1nGjU0uQ3A25EzwuEdrYcrb3D+DzswSwFg6p2J3iCZNoMpTaHdZKAJBY9B3xe8JwEooxF48m1UUNuj0EbqBgrrOgsr2kfwk8vjy0rwigJi5v1fdhjCMfelIVmqceXy/4tSmKBxS6Igt1mSsloc4wgLEiJpQvm4G5zPwq2xvmLy6y9kCpZsy9eB2aarIQuijBgCLEnxYSia+AnIkPUyNocA12werIz0unol6s/oN45amb+LuZlSvByFdacedmamajLX0eNVfy4E0pqtsVz1X5YJnUsoQK/bh0EO5PLUs+/yq7cv5wRBPGU6V4HCmiD1ZEa1L51+j0RolEMTxVRLqXXIaO+/ONYPGOoPGrIL3rSZapuG0IgvUI3XXNqnBbHN0bvZfEfkXa2PqvpRBIXq52V09zrwhJtwI+dhvAjxpKXpb8EGAC1AzS9LEFQkQAAAABJRU5ErkJggg==" height="16"/></symbol><g ed:height="56" ed:width="357" ed:layout="rightmap" id="102" transform="matrix(1,0,0,1,28,578)" ed:parentid="101"><path stroke="#424f58" d="M4,0L353,0C355.2,0,357,1.8,357,4L357,52C357,54.2,355.2,56,353,56L4,56C1.8,56,0,54.2,0,52L0,4C0,1.8,1.8,0,4,0z" stroke-linejoin="round" fill="#424f58"/><text class="st2"><tspan style="white-space:pre" x="19" y="22.4">1.利用&lt;tx:annotation-driven />自定义标签</tspan><tspan style="white-space:pre" x="19" y="42.5">向容器中添加有关事务相关的beanDefinition</tspan></text></g><g ed:height="21" ed:width="269" ed:layout="rightmap" id="104" transform="matrix(1,0,0,1,412,230)" ed:parentid="102"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.1.解析自定义标签&lt;tx:annotation-driven /></tspan></text></g><g ed:height="21" ed:width="500" ed:layout="rightmap" id="106" transform="matrix(1,0,0,1,708,89)" ed:parentid="104"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.1.1.获取tx标签的命名空间，根据命名空间寻找对应的NamespaceHandlerSupport子类</tspan></text></g><g ed:height="21" ed:width="669" ed:layout="rightmap" id="108" transform="matrix(1,0,0,1,708,117)" ed:parentid="104"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.1.2.查看自定义TxNamespaceHandler处理器中init()方法注册的annotation-driven对应的BeanDefinitionParser解析器</tspan></text></g><g ed:height="21" ed:width="566" ed:layout="rightmap" id="110" transform="matrix(1,0,0,1,708,144)" ed:parentid="104"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.1.3.找到AnnotationDrivenBeanDefinitionParser解析器，查看parse()中对应解析自定义标签的逻辑</tspan></text></g><g ed:height="21" ed:width="181" ed:layout="rightmap" id="112" transform="matrix(1,0,0,1,708,257)" ed:parentid="104"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.1.4.解析自定义标签属性</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>&amp;lt;tx:annotation-driven&amp;gt; 一共有四个属性如下：&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体';&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>mode：指定Spring事务管理框架创建通知 bean 的方式。可用的值有 proxy 和 aspectj。前者是默认值，表示通知对象是个JDK代理；后者表示Spring AOP会使用 AspectJ 创建代理&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>proxy-target-class：如果为 true，Spring将创建子类来代理业务类；如果为 false，则使用基于接口的代理。（如果使用子类代理，需要在类路径中添加CGLib.jar类库）&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>order：如果业务类除事务切面外，还需要织入其他的切面，通过该属性可以控制事务切面在目标连接点的织入顺序。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>transaction-manager：指定到现有的 PlatformTransactionManager bean 的引用，通知会使用该引用。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体';&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * 事务的annotation-driven标签的的解析&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * Parses the {@code &amp;lt;tx:annotation-driven/&amp;gt;} tag. Will&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * {@link AopNamespaceUtils#registerAutoProxyCreatorIfNecessary register an AutoProxyCreator}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * with the container as necessary.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>@Override&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>@Nullable&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>public&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> BeanDefinition &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>parse&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>Element element&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> ParserContext parserContext&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>registerTransactionalEventListenerFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>parserContext&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 获取mode属性设置&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    String mode &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> element&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;mode&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;aspectj&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>equals&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>mode&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>))&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// mode=&amp;quot;aspectj&amp;quot;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>registerTransactionAspect&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>element&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> parserContext&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>ClassUtils&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isPresent&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;javax.transaction.Transactional&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>().&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getClassLoader&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()))&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>registerJtaTransactionAspect&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>element&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> parserContext&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>else&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// mode=&amp;quot;proxy&amp;quot;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        AopAutoProxyConfigurer&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>configureAutoProxyCreator&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>element&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> parserContext&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(155,4)"/></g></g><symbol id="note"><image width="16" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyOTkwNTNiYS1iMTE3LWZiNDQtOTgwYy1mYjkwYzFiNzJlMWUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkYyRkU5OTU5Nzg0MTFFNzlFMjZFQTA0OUExMTI5NjAiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkYyRkU5OTQ5Nzg0MTFFNzlFMjZFQTA0OUExMTI5NjAiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MmY3M2I2ZDQtOWU4NC04ZDQ4LTk5NzItZDE3ODAwZjMyZDYzIiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YzQ3Yzk0OWQtMGQ1Ny0xMWU3LTkzMmUtYzliNjJlYTc1ZTM1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+K193vQAAAZpJREFUeNqkU0svA1EYPXe01UxV0npUSZTUBgtCk6Z2NmJj7R9YsKrHyiMRfoAtWxt/gWAhIkGaSEQqwdBWQrRlKp161PT6xijaejU9yZ17c+ee893z3e9jnHOUAoP2mZpbKkpltP+SEWDzzOoCGuanh/5FTqwunyvbFpdynwzZPIBQTOSHyA0eD9Xmpwhfp9H2YSGLncDRj2RvQxjcaEO61o7U8UlLmr0s0HZfjoCvqy2PxgD+AkTXwO73IKZOkRmYAI9eR+TtjfGCG2iJyYGqAPFNQN4FUhJgqoYYWzyz2O/61Iwi/WnBVx8ESwbJfJjINXQbFTMrne6xXkmy+g0oEOjpbn+b048JsNgqWCJAkS8A8g7BCN7op79rlAsTWLlQKKCzozDKW0Ay8BlZE2gaJpJTP6MVX0YvHSHfwvPVAXneJ3IIKHfQLiXRNUJr57evkyPgaW2EQUlBfagDyuw0RKBlEjDX/V7KWURjcZjlW9jsbvCKdjCHl05U/t0LWZitVRA7BiGIYnHN9N5Q/6/pL/XCSm3nVwEGAAA2iwis0BevAAAAAElFTkSuQmCC" height="16"/></symbol><g ed:height="21" ed:width="418" ed:layout="rightmap" id="114" transform="matrix(1,0,0,1,708,371)" ed:parentid="104"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.1.5.parse()方法返回null，表明该自定义标签仅仅用于配置，不生成bean</tspan></text></g><g ed:height="21" ed:width="278" ed:layout="rightmap" id="116" transform="matrix(1,0,0,1,916,230)" ed:parentid="112"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.1.4.1.硬编码在容器中注册事务事件监听器工厂</tspan></text></g><g ed:height="21" ed:width="177" ed:layout="rightmap" id="118" transform="matrix(1,0,0,1,916,329)" ed:parentid="112"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.1.4.2.解析mode属性值</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>自定义 annotation-driven 标签的 mode 属性值，属性值默认为 proxy，除此之外可以配置成 aspectj。proxy 是代理模式，仅在外部方法调用才会被代理截获，自身方法调用，即使配置了 @Transactional 注解事务也无法生效，此外代理模式也不能应用在非 public 方法上；而 aspectj 模式与代理模式不同，aspectj 模式可以自身方法调用，也可以应用在非 public 方法上。&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(151,4)"/></g></g><g ed:height="21" ed:width="179" ed:layout="rightmap" id="120" transform="matrix(1,0,0,1,1221,172)" ed:parentid="116"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">新建RootBeanDefinition对象</tspan></text></g><g ed:height="38" ed:width="490" ed:layout="rightmap" id="122" transform="matrix(1,0,0,1,1221,199)" ed:parentid="116"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">设置beanDefinition的class为TransactionalEventListenerFactory，name为</tspan><tspan style="white-space:pre" x="9" y="31.4">org.springframework.transaction.config.internalTransactionalEventListenerFactory</tspan></text></g><g ed:height="21" ed:width="175" ed:layout="rightmap" id="124" transform="matrix(1,0,0,1,1221,244)" ed:parentid="116"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">容器中注册该beanDefinition</tspan></text></g><g ed:height="38" ed:width="581" ed:layout="rightmap" id="126" transform="matrix(1,0,0,1,1221,271)" ed:parentid="116"><path d="M0,0L581,0L581,38L0,38L0,0z" fill="#30c9f7"/><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">将事务事件监听器工厂beanDefinition包装成BeanComponentDefinition，并通知ReaderEventListener</tspan><tspan style="white-space:pre" x="9" y="31.4">监听器调用监听器的componentRegistered(componentDefinition)方法</tspan></text></g><g ed:height="21" ed:width="224" ed:layout="rightmap" id="128" transform="matrix(1,0,0,1,1120,316)" ed:parentid="118"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">mode="aspectj"——静态AOP的方式</tspan></text></g><g ed:height="21" ed:width="428" ed:layout="rightmap" id="130" transform="matrix(1,0,0,1,1120,343)" ed:parentid="118"><text class="st4"><tspan style="white-space:pre" x="9" class="st5" y="14.4">mode="proxy"——动态AOP方式 (书写方便，流程转到</tspan><tspan style="white-space:pre">1.2、1.3、1.4、1.5</tspan><tspan style="white-space:pre" class="st5">)</tspan></text></g><g ed:height="21" ed:width="150" ed:layout="rightmap" id="152" transform="matrix(1,0,0,1,412,503)" ed:parentid="102"><path d="M0,0L150,0L150,21L0,21L0,0z" fill="#cde6c7"/><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.注册自动代理创建器</tspan></text></g><g ed:height="38" ed:width="366" ed:layout="rightmap" id="159" transform="matrix(1,0,0,1,589,445)" ed:parentid="152"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.1.容器中注册/升级InfrastructureAdvisorAutoProxyCreator</tspan><tspan style="white-space:pre" x="10" y="31.4">（AOP中提及到优先级最低的自动代理创建器）</tspan></text></g><g ed:height="21" ed:width="660" ed:layout="rightmap" id="160" transform="matrix(1,0,0,1,982,398)" ed:parentid="159"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.1.1.查看容器中是否注册了name为org.springframework.aop.config.internalAutoProxyCreator的beanDefinition</tspan></text></g><g ed:height="21" ed:width="931" ed:layout="rightmap" id="161" transform="matrix(1,0,0,1,982,426)" ed:parentid="159"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.1.2.如果容器不包含该name的beanDefinition，则创建该名且类型为InfrastructureAdvisorAutoProxyCreator的beanDefinition，并注册进容器中等待后续一并实例化</tspan></text></g><g ed:height="21" ed:width="667" ed:layout="rightmap" id="162" transform="matrix(1,0,0,1,982,453)" ed:parentid="159"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.1.3.如果容器包含该name的beanDefinition，则需要进一步判断类型是否为InfrastructureAdvisorAutoProxyCreator</tspan></text></g><g ed:height="21" ed:width="539" ed:layout="rightmap" id="163" transform="matrix(1,0,0,1,982,481)" ed:parentid="159"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.1.4.如果类型正好是InfrastructureAdvisorAutoProxyCreator，则不需要任何处理，直接返回</tspan></text></g><g ed:height="21" ed:width="1025" ed:layout="rightmap" id="164" transform="matrix(1,0,0,1,982,508)" ed:parentid="159"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.1.5.如果类型不是InfrastructureAdvisorAutoProxyCreator，则需要查看按照优先级列表决定是否进行修改现有的beanDefinition的类型为InfrastructureAdvisorAutoProxyCreator</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>优先级存储在了 APC_PRIORITY_LIST 中，APC_PRIORITY_LIST 在 AopConfigUtils 的静态代码块中进行了初始化。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体';&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>static {&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>   APC_PRIORITY_LIST.add(InfrastructureAdvisorAutoProxyCreator.class);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>   APC_PRIORITY_LIST.add(AspectJAwareAdvisorAutoProxyCreator.class);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>   APC_PRIORITY_LIST.add(AnnotationAwareAspectJAutoProxyCreator.class);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体';&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体';&quot;>&lt;br />&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(999,4)"/></g></g><g ed:height="38" ed:width="445" ed:layout="rightmap" id="182" transform="matrix(1,0,0,1,589,549)" ed:parentid="152"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.2.处理&lt;tx:annotation-driven />的proxy-target-class属性</tspan><tspan style="white-space:pre" x="10" y="31.4">（本质是设置InfrastructureAdvisorAutoProxyCreator对象中对应属性）</tspan></text></g><g ed:height="21" ed:width="299" ed:layout="rightmap" id="183" transform="matrix(1,0,0,1,1061,536)" ed:parentid="182"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.2.1.查看proxy-target-class属性是否设置为true</tspan></text></g><g ed:height="38" ed:width="584" ed:layout="rightmap" id="184" transform="matrix(1,0,0,1,1061,563)" ed:parentid="182"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.2.2.如果设置了为true，就给前一步的org.springframework.aop.config.internalAutoProxyCreator</tspan><tspan style="white-space:pre" x="10" y="31.4">的beanDefinition添加一个name为proxyTargetClass，value为true的PropertyValue (设置属性)</tspan></text></g><g ed:height="21" ed:width="976" ed:layout="rightmap" id="188" transform="matrix(1,0,0,1,589,608)" ed:parentid="152"><path d="M0,0L976,0L976,21L0,21L0,0z" fill="#30c9f7"/><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.2.3.将自动代理创建器BeanDefinition包装成BeanComponentDefinition，并通知ReaderEventListener监听器调用监听器的componentRegistered(componentDefinition)方法</tspan></text></g><g ed:height="38" ed:width="383" ed:layout="rightmap" id="191" transform="matrix(1,0,0,1,412,668)" ed:parentid="102"><path d="M0,0L383,0L383,38L0,38L0,0z" fill="#cde6c7"/><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.3.注册事务注解信息解析帮助类</tspan><tspan style="white-space:pre" x="10" y="31.4">(帮助解析事务注解信息，封装并保存成TransactionAttribute等)</tspan></text></g><g ed:height="21" ed:width="722" ed:layout="rightmap" id="193" transform="matrix(1,0,0,1,822,635)" ed:parentid="191"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.3.1.创建beanClass为org.springframework.transaction.annotation.AnnotationTransactionAttributeSource的beanDefinition</tspan></text></g><g ed:height="21" ed:width="285" ed:layout="rightmap" id="195" transform="matrix(1,0,0,1,822,663)" ed:parentid="191"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.3.2.标注beanDefinition为基础设施类型的bean</tspan></text></g><g ed:height="21" ed:width="521" ed:layout="rightmap" id="197" transform="matrix(1,0,0,1,822,690)" ed:parentid="191"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.3.3.利用Spring默认规则给beanDefinition设置beanName，规则：[beanClass]+"#"+编号</tspan></text></g><g ed:height="21" ed:width="220" ed:layout="rightmap" id="199" transform="matrix(1,0,0,1,822,718)" ed:parentid="191"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.3.4.将beanDefinition注册到容器中</tspan></text></g><g ed:height="21" ed:width="126" ed:layout="rightmap" id="201" transform="matrix(1,0,0,1,412,814)" ed:parentid="102"><path d="M0,0L126,0L126,21L0,21L0,0z" fill="#cde6c7"/><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.4.注册事务拦截器</tspan></text></g><g ed:height="21" ed:width="150" ed:layout="rightmap" id="203" transform="matrix(1,0,0,1,412,993)" ed:parentid="102"><path d="M0,0L150,0L150,21L0,21L0,0z" fill="#cde6c7"/><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.5.注册事务属性增强器</tspan></text></g><g ed:height="21" ed:width="375" ed:layout="rightmap" id="205" transform="matrix(1,0,0,1,565,745)" ed:parentid="201"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.4.1.创建beanClass为TransactionInterceptor的beanDefinition</tspan></text></g><g ed:height="21" ed:width="305" ed:layout="rightmap" id="207" transform="matrix(1,0,0,1,565,814)" ed:parentid="201"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.4.3.设置transactionManagerBeanName的属性值</tspan></text></g><g ed:height="21" ed:width="587" ed:layout="rightmap" id="209" transform="matrix(1,0,0,1,565,855)" ed:parentid="201"><text class="st4"><tspan style="white-space:pre" x="10" y="14.4">1.4.4.</tspan><tspan style="white-space:pre" class="st5">设置transactionAttributeSource的属性值为</tspan><tspan style="white-space:pre">1.3步骤</tspan><tspan style="white-space:pre" class="st5">注册的AnnotationTransactionAttributeSource</tspan></text></g><g ed:height="21" ed:width="285" ed:layout="rightmap" id="211" transform="matrix(1,0,0,1,565,773)" ed:parentid="201"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.4.2.标注beanDefinition为基础设施类型的bean</tspan></text></g><g ed:height="21" ed:width="550" ed:layout="rightmap" id="217" transform="matrix(1,0,0,1,897,800)" ed:parentid="207"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.4.3.1.利用TxNamespaceHandler解析&lt;tx:annotation-driven />中transaction-manager属性值</tspan></text></g><g ed:height="21" ed:width="651" ed:layout="rightmap" id="219" transform="matrix(1,0,0,1,897,828)" ed:parentid="207"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.4.3.2.给beanDefinition添加一个PropertyValue (name为transactionManagerBeanName为value为解析的属性值)</tspan></text></g><g ed:height="21" ed:width="538" ed:layout="rightmap" id="222" transform="matrix(1,0,0,1,565,883)" ed:parentid="201"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.4.5.利用Spring默认规则给beanDefinition设置beanName，并将beanDefinition注册到容器中</tspan></text></g><g ed:height="21" ed:width="515" ed:layout="rightmap" id="226" transform="matrix(1,0,0,1,589,910)" ed:parentid="203"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.5.1.创建beanClass为BeanFactoryTransactionAttributeSourceAdvisor的beanDefinition</tspan></text></g><g ed:height="21" ed:width="178" ed:layout="rightmap" id="227" transform="matrix(1,0,0,1,589,1034)" ed:parentid="203"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.5.5.设置order的属性值</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#ffffff;&quot;>如果业务类除事务切面外，还需要织入其他的切面，通过该属性可以控制事务切面在目标连接点的织入顺序。&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(152,4)"/></g></g><g ed:height="21" ed:width="587" ed:layout="rightmap" id="228" transform="matrix(1,0,0,1,589,965)" ed:parentid="203"><text class="st4"><tspan style="white-space:pre" x="10" y="14.4">1.5.3.</tspan><tspan style="white-space:pre" class="st5">设置transactionAttributeSource的属性值为</tspan><tspan style="white-space:pre">1.3步骤</tspan><tspan style="white-space:pre" class="st5">注册的AnnotationTransactionAttributeSource</tspan></text></g><g ed:height="21" ed:width="285" ed:layout="rightmap" id="229" transform="matrix(1,0,0,1,589,938)" ed:parentid="203"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.5.2.标注beanDefinition为基础设施类型的bean</tspan></text></g><g ed:height="21" ed:width="310" ed:layout="rightmap" id="230" transform="matrix(1,0,0,1,794,1020)" ed:parentid="227"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.5.5.1.解析&lt;tx:annotation-driven />中order属性值</tspan></text></g><g ed:height="21" ed:width="503" ed:layout="rightmap" id="231" transform="matrix(1,0,0,1,794,1048)" ed:parentid="227"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.5.5.2.给beanDefinition添加一个PropertyValue (name为order为value为解析的属性值)</tspan></text></g><g ed:height="21" ed:width="220" ed:layout="rightmap" id="232" transform="matrix(1,0,0,1,589,1075)" ed:parentid="203"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.5.6.将beanDefinition注册到容器中</tspan></text></g><g ed:height="21" ed:width="446" ed:layout="rightmap" id="238" transform="matrix(1,0,0,1,589,993)" ed:parentid="203"><text class="st4"><tspan style="white-space:pre" x="10" y="14.4">1.5.4.</tspan><tspan style="white-space:pre" class="st5">设置adviceBeanName的属性值为</tspan><tspan style="white-space:pre">1.4步骤</tspan><tspan style="white-space:pre" class="st5">注册的TransactionInterceptor</tspan></text></g><g ed:height="21" ed:width="1335" ed:layout="rightmap" id="240" transform="matrix(1,0,0,1,412,1103)" ed:parentid="102"><path d="M0,0L1335,0L1335,21L0,21L0,0z" fill="#30c9f7"/><text class="st4"><tspan style="white-space:pre" x="10" y="14.4">1.6.</tspan><tspan style="white-space:pre" class="st5">创建CompositeComponentDefinition容器，将</tspan><tspan style="white-space:pre">1.3、1.4、1.5</tspan><tspan style="white-space:pre" class="st5">创建的beanDefinition分别包装成BeanComponentDefinition并添加进容器，并通知ReaderEventListener监听器调用监听器的componentRegistered(componentDefinition)方法</tspan></text></g><g ed:height="56" ed:width="321" ed:layout="rightmap" id="246" transform="matrix(1,0,0,1,46,1174)" ed:parentid="101"><path stroke="#424f58" d="M4,0L317,0C319.2,0,321,1.8,321,4L321,52C321,54.2,319.2,56,317,56L4,56C1.8,56,0,54.2,0,52L0,4C0,1.8,1.8,0,4,0z" stroke-linejoin="round" fill="#424f58"/><text class="st2"><tspan style="white-space:pre" x="19" y="22.4">2.实例化第1步中注册四个beanDefinition</tspan><tspan style="white-space:pre" x="19" y="42.5">(参考ApplicationContext的刷新流程)</tspan></text></g><g ed:height="21" ed:width="303" ed:layout="rightmap" id="248" transform="matrix(1,0,0,1,394,1150)" ed:parentid="246"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">2.1.实例化InfrastructureAdvisorAutoProxyCreator</tspan></text></g><g ed:height="21" ed:width="298" ed:layout="rightmap" id="250" transform="matrix(1,0,0,1,394,1192)" ed:parentid="246"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">2.2.实例化AnnotationTransactionAttributeSource</tspan></text></g><g ed:height="21" ed:width="210" ed:layout="rightmap" id="252" transform="matrix(1,0,0,1,394,1219)" ed:parentid="246"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">2.3.实例化TransactionInterceptor</tspan></text></g><g ed:height="21" ed:width="350" ed:layout="rightmap" id="256" transform="matrix(1,0,0,1,394,1247)" ed:parentid="246"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">2.4.实例化BeanFactoryTransactionAttributeSourceAdvisor</tspan></text></g><g ed:height="21" ed:width="562" ed:layout="rightmap" id="258" transform="matrix(1,0,0,1,724,1137)" ed:parentid="248"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">2.1.1.在ApplicationContext刷新过程的第七步会进行bean后处理器的实例化，并注册到后处理器链中</tspan></text></g><g ed:height="21" ed:width="666" ed:layout="rightmap" id="259" transform="matrix(1,0,0,1,724,1164)" ed:parentid="248"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">2.1.2.在其他普通beanDefinition实例化为bean时会进行调用InfrastructureAdvisorAutoProxyCreator的所有后处理方法</tspan></text></g><g ed:height="27" ed:width="755.6" ed:layout="rightmap" id="263" transform="matrix(1,0,0,1,718,1202)" ed:parentid="262"><path stroke="#ff783c" d="M13.5,0L742.1,0C749.6,0,755.6,6,755.6,13.5C755.6,21,749.6,27,742.1,27L13.5,27C6,27,0,21,0,13.5C0,6,6,0,13.5,0z" stroke-linejoin="round" fill="#ffffff"/><text class="st4"><tspan style="white-space:pre" x="12" class="st5" y="16.4">在ApplicationContext刷新过程的</tspan><tspan style="white-space:pre">第12步</tspan><tspan style="white-space:pre" class="st5">[提前初始化剩下的非惰性的单例bean]时发生，但必定会在用户使用的普通bean之前实例化成功</tspan></text></g><g ed:height="56" ed:width="371" ed:layout="rightmap" id="273" transform="matrix(1,0,0,1,21,1799)" ed:parentid="101"><path stroke="#424f58" d="M4,0L367,0C369.2,0,371,1.8,371,4L371,52C371,54.2,369.2,56,367,56L4,56C1.8,56,0,54.2,0,52L0,4C0,1.8,1.8,0,4,0z" stroke-linejoin="round" fill="#424f58"/><text class="st2"><tspan style="white-space:pre" x="19" y="22.5">3.激活InfrastructureAdvisorAutoProxyCreator</tspan><tspan style="white-space:pre" x="126" y="42.5">(参考AOP的流程)</tspan></text></g><g ed:height="21" ed:width="573" ed:layout="rightmap" id="289" transform="matrix(1,0,0,1,419,1281)" ed:parentid="273"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">3.1.在每一个普通bean的实例化前，调用postProcessBeforeInstantiation()方法，完全和AOP流程一致</tspan></text></g><g ed:height="36" ed:width="361" ed:layout="rightmap" id="309" transform="matrix(1,0,0,1,26,2902)" ed:parentid="101"><path stroke="#424f58" d="M4,0L357,0C359.2,0,361,1.8,361,4L361,32C361,34.2,359.2,36,357,36L4,36C1.8,36,0,34.2,0,32L0,4C0,1.8,1.8,0,4,0z" stroke-linejoin="round" fill="#424f58"/><text class="st2"><tspan style="white-space:pre" x="19" y="22.5">4.执行代理对象的事务等增强方法/拦截器调用链</tspan></text></g><g ed:height="38" ed:width="287" ed:layout="rightmap" id="327" transform="matrix(1,0,0,1,419,1822)" ed:parentid="273"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">3.2.在每一个普通bean初始化完后，</tspan><tspan style="white-space:pre" x="10" y="31.4">调用postProcessAfterInitialization()方法</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * 实现BeanPostProcessor接口方法，可能返回代理对象&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * Create a proxy with the configured interceptors if the bean is&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * identified as one to proxy by the subclass.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @see #getAdvicesAndAdvisorsForBean&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>@Override&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>public&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Object &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>postProcessAfterInitialization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>@Nullable Object bean&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> String beanName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>bean &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 根据给定的bean的class和name构建出个key&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        Object cacheKey &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getCacheKey&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>bean&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(),&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> beanName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>earlyProxyReferences&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>contains&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>cacheKey&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>))&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 如果它适合被代理，则需要封装指定bean&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>wrapIfNecessary&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>bean&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> beanName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> cacheKey&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> bean&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(261,12)"/></g></g><g ed:height="21" ed:width="315" ed:layout="rightmap" id="328" transform="matrix(1,0,0,1,733,1308)" ed:parentid="327"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">3.2.1.根据目标bean的class和name构建出个cacheKey</tspan></text></g><g ed:height="21" ed:width="273" ed:layout="rightmap" id="329" transform="matrix(1,0,0,1,733,1831)" ed:parentid="327"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">3.2.2.包装指定的目标bean，可能返回代理对象</tspan></text></g><g ed:height="21" ed:width="597" ed:layout="rightmap" id="330" transform="matrix(1,0,0,1,1033,1336)" ed:parentid="329"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">3.2.2.1.如果targetSourcedBeans中缓存中已经包含beanName，说明已经在3.1中处理过直接返回本身即可</tspan></text></g><g ed:height="21" ed:width="494" ed:layout="rightmap" id="331" transform="matrix(1,0,0,1,1033,1363)" ed:parentid="329"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">3.2.2.2.如果advisedBeans缓存中记录该beanName无需进行代理增强，也直接返回本身</tspan></text></g><g ed:height="21" ed:width="968" ed:layout="rightmap" id="332" transform="matrix(1,0,0,1,1033,1391)" ed:parentid="329"><text class="st4"><tspan style="white-space:pre" x="10" y="14.4">3.2.2.3.</tspan><tspan style="white-space:pre" class="st5">给定的bean类是否代表一个基础设施类 (基础设施类不应代理)，则在advisedBeans中记录该beanName无需代理，并直接返回本身 (</tspan><tspan style="white-space:pre">和AOP差异在于默认认为是不跳过的</tspan><tspan style="white-space:pre" class="st5">)</tspan></text></g><g ed:height="21" ed:width="583" ed:layout="rightmap" id="333" transform="matrix(1,0,0,1,1033,1679)" ed:parentid="329"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">3.2.2.4.到这说明，可能需要进行代理，故先尝试获取匹配目标bean的增强器链 (由所有通知和增强器组成)</tspan></text></g><g ed:height="21" ed:width="734" ed:layout="rightmap" id="334" transform="matrix(1,0,0,1,1643,1418)" ed:parentid="333"><text class="st4"><tspan style="white-space:pre" x="9" class="st5" y="14.4">获取所有的增强器，主要包括用户XML配置的、@AspectJ注解的和BeanFactoryTransactionAttributeSourceAdvisor (</tspan><tspan style="white-space:pre">流程参考AOP</tspan><tspan style="white-space:pre" class="st5">)</tspan></text></g><g ed:height="21" ed:width="674" ed:layout="rightmap" id="336" transform="matrix(1,0,0,1,1033,1968)" ed:parentid="329"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">3.2.2.5.如果获取到的增强器链不为空，则在advisedBeans中记录该beanName需要被代理；如果为空，记录为不需要代理</tspan></text></g><g ed:height="21" ed:width="288" ed:layout="rightmap" id="337" transform="matrix(1,0,0,1,1643,1679)" ed:parentid="333"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">在所有增强器过滤出适用于该bean的增强器并应用</tspan></text></g><g ed:height="21" ed:width="535" ed:layout="rightmap" id="343" transform="matrix(1,0,0,1,1643,1941)" ed:parentid="333"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">对所有的增强器按照用户定义的优先级进行逆向排序，调整增强器链的顺序，便于后续执行增强器</tspan></text></g><g ed:height="21" ed:width="571" ed:layout="rightmap" id="344" transform="matrix(1,0,0,1,1033,2161)" ed:parentid="329"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">3.2.2.6.利用SingletonTargetSource包装的目标bean，创建并返回SingletonTargetSource的代理对象</tspan></text></g><g ed:height="21" ed:width="244" ed:layout="rightmap" id="346" transform="matrix(1,0,0,1,733,2353)" ed:parentid="327"><path d="M0,0L244,0L244,21L0,21L0,0z" fill="#ead6e8"/><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">3.2.3.当返回为代理对象，即偷梁换柱成功</tspan></text></g><g ed:height="21" ed:width="514" ed:layout="rightmap" id="348" transform="matrix(1,0,0,1,771,1247)" ed:parentid="256"><text class="st4"><tspan style="white-space:pre" x="10" y="14.4">2.4.1.</tspan><tspan style="white-space:pre" class="st5">在创建任意bean的时候，由于执行</tspan><tspan style="white-space:pre">3.2.2.4</tspan><tspan style="white-space:pre" class="st5">流程，获取容器中所有增强器时会进行实例化</tspan></text></g><g ed:height="21" ed:width="154" ed:layout="rightmap" id="366" transform="matrix(1,0,0,1,1631,2147)" ed:parentid="344"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">1.创建ProxyFactory对象</tspan></text></g><g ed:height="21" ed:width="753" ed:layout="rightmap" id="367" transform="matrix(1,0,0,1,1631,2326)" ed:parentid="344"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">2.委托ProxyFactory创建代理对象，使用JDK动态代理方式，创建JdkDynamicAopProxy对象并调用getProxy()方法获取代理增强对象</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>config就是刚刚创建的ProxyFactory对象&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Arial';&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * 创建动态代理的真正地方：JDK和CGlib&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @param config the AOP configuration in the form of an&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * AdvisedSupport object&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @return&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @throws AopConfigException&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>@Override&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>public&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> AopProxy &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>createAopProxy&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>AdvisedSupport config&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> throws AopConfigException &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// optimize用来控制通过CGlib创建的代理是否使用激进的优化策略&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// proxyTargetClass为true时，目标类本身被代理而不是目标类的接口，设置方式为&amp;lt;aop:aspectj-autoproxy proxy-target-class=&amp;quot;true&amp;quot;/&amp;gt;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// hasNoUserSuppliedProxyInterfaces:是否存在代理接口，否为true&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>config&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isOptimize&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>||&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> config&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isProxyTargetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>||&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>hasNoUserSuppliedProxyInterfaces&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>config&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>))&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> targetClass &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> config&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getTargetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>();&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>targetClass &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>throw&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>AopConfigException&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;TargetSource cannot determine target class: &amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Either an interface or a target is required for proxy creation.&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>targetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isInterface&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>||&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Proxy&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isProxyClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>targetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>))&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// JDK动态代理&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>JdkDynamicAopProxy&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>config&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// CGlib动态代理&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>ObjenesisCglibAopProxy&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>config&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>else&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// JDK动态代理&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>JdkDynamicAopProxy&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>config&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * JDK动态代理获取代理增强对象&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @return&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>@Override&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>public&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Object &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getProxy&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>@Nullable ClassLoader classLoader&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>logger&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isDebugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>())&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        logger&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>debug&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Creating JDK dynamic proxy: target source is &amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>advised&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getTargetSource&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>());&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 获取接口&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>[]&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> proxiedInterfaces &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> AopProxyUtils&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>completeProxiedInterfaces&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>advised&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>true&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>findDefinedEqualsAndHashCodeMethods&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>proxiedInterfaces&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 该类实现了InvocationHandler接口，所以传this&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Proxy&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>newProxyInstance&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>classLoader&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> proxiedInterfaces&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(727,4)"/></g></g><g ed:height="21" ed:width="154" ed:layout="rightmap" id="368" transform="matrix(1,0,0,1,1812,1996)" ed:parentid="366"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">a.新建ProxyFactory实例</tspan></text></g><g ed:height="21" ed:width="423" ed:layout="rightmap" id="369" transform="matrix(1,0,0,1,1812,2023)" ed:parentid="366"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">b.拷贝部分AbstractAutoProxyCreator的属性设置给ProxyFactory对象</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * Copy configuration from the other config object.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @param other object to copy configuration from&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>public&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>void&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>copyFrom&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>ProxyConfig other&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    Assert&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>notNull&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>other&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Other ProxyConfig object must not be null&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>proxyTargetClass &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> other&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>proxyTargetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>optimize &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> other&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>optimize&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>exposeProxy &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> other&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>exposeProxy&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>frozen &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> other&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>frozen&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>opaque &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> other&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>opaque&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(397,4)"/></g></g><g ed:height="21" ed:width="388" ed:layout="rightmap" id="370" transform="matrix(1,0,0,1,1812,2078)" ed:parentid="366"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">c.判断是否直接对目标类代理，还是对目标类实现的接口进行代理</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 决定对于给定的原始bean是否直接对它的类型（targetClass）进行代理而不是对它实现的接口进行代理&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 检查proxyFactory的proxyTargetClass属性设置以及目标bean的beanDefinition中preserveTargetClass属性设置&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>proxyFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isProxyTargetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>())&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>shouldProxyTargetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>beanClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> beanName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>))&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 如果beanDefinition中preserveTargetClass属性为true，那么将proxyTargetClass属性设置true&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        proxyFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>setProxyTargetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>true&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>else&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 试图寻找合适的接口进行代理，如果没有则还是将proxyTargetClass属性设置true&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>evaluateProxyInterfaces&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>beanClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> proxyFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * 返回是否直接代理目标类以及任何接口&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * Return whether to proxy the target class directly as well as any interfaces.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>public&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> boolean &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isProxyTargetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>proxyTargetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * 根据beanDefinition中preserveTargetClass属性配置判断是否应该代理&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * Determine whether the given bean should be proxied with its target&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * class rather than its interfaces. Checks the&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * {@link #PRESERVE_TARGET_CLASS_ATTRIBUTE &amp;quot;preserveTargetClass&amp;quot; attribute}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * of the corresponding bean definition.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @param beanFactory the containing ConfigurableListableBeanFactory&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @param beanName the name of the bean&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @return whether the given bean should be proxied with its target class&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>public&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>static&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> boolean &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>shouldProxyTargetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>ConfigurableListableBeanFactory beanFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> @Nullable String beanName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>beanName &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;amp;&amp;amp;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> beanFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>containsBeanDefinition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>beanName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>))&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        BeanDefinition bd &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> beanFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getBeanDefinition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>beanName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// beanDefinition中是否定义了preserveTargetClass属性为true&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Boolean&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>TRUE&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>equals&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>bd&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>PRESERVE_TARGET_CLASS_ATTRIBUTE&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>));&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>false&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * Check the interfaces on the given bean class and apply them to the {@link ProxyFactory},&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * if appropriate.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * &amp;lt;p&amp;gt;Calls {@link #isConfigurationCallbackInterface} and {@link #isInternalLanguageInterface}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * to filter for reasonable proxy interfaces, falling back to a target-class proxy otherwise.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @param beanClass the class of the bean&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @param proxyFactory the ProxyFactory for the bean&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>protected&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>void&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>evaluateProxyInterfaces&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> beanClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> ProxyFactory proxyFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 获取目标bean类实现的所有接口&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>[]&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> targetInterfaces &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> ClassUtils&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getAllInterfacesForClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>beanClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getProxyClassLoader&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>());&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    boolean hasReasonableProxyInterface &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>false&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 遍历所有的接口&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>for&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> ifc &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>:&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> targetInterfaces&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isConfigurationCallbackInterface&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>ifc&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;amp;&amp;amp;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isInternalLanguageInterface&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>ifc&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;amp;&amp;amp;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            ifc&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getMethods&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>().&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>length &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>0&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            hasReasonableProxyInterface &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>true&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>break&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>hasReasonableProxyInterface&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// Must allow for introductions; can't just set interfaces to the target's interfaces only.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>for&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> ifc &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>:&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> targetInterfaces&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 添加代理接口&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            proxyFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>addInterface&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>ifc&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>else&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 如果没有合适的接口可以代理，最终还是将proxyTargetClass属性设置为true&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        proxyFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>setProxyTargetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>true&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(362,4)"/></g></g><g ed:height="21" ed:width="165" ed:layout="rightmap" id="371" transform="matrix(1,0,0,1,1812,2161)" ed:parentid="366"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">d.封装所有增强器、拦截器</tspan></text></g><g ed:height="21" ed:width="431" ed:layout="rightmap" id="372" transform="matrix(1,0,0,1,2004,2133)" ed:parentid="371"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">实例化AbstractAutoProxyCreator中interceptorNames中包含的所有拦截器</tspan></text></g><g ed:height="21" ed:width="378" ed:layout="rightmap" id="373" transform="matrix(1,0,0,1,2004,2161)" ed:parentid="371"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">利用AdvisorAdapterRegistry封装实例化好的拦截器为Advisor</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * Resolves the specified interceptor names to Advisor objects.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @see #setInterceptorNames&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>private&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Advisor&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>[]&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>resolveInterceptorNames&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    BeanFactory bf &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>beanFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    ConfigurableBeanFactory cbf &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>bf &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>instanceof&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>ConfigurableBeanFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>ConfigurableBeanFactory&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> bf &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>:&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    List &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Advisor &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> advisors &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>ArrayList&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>();&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 遍历this.interceptorNames属性(由XML配置文件设置)，实例化对应的bean，用适配器进行包装&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>for&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>String beanName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>:&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>interceptorNames&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>cbf &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>||&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>cbf&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isCurrentlyInCreation&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>beanName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>))&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            Assert&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>state&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>bf &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;BeanFactory required for resolving interceptor names&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            Object next &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> bf&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getBean&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>beanName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            advisors&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>add&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>advisorAdapterRegistry&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>wrap&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>next&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>));&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> advisors&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>toArray&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>Advisor&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>[&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>0&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>]);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(352,4)"/></g></g><g ed:height="21" ed:width="415" ed:layout="rightmap" id="374" transform="matrix(1,0,0,1,2004,2188)" ed:parentid="371"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">将之前获取到的增强器链和前两步获得到的拦截器整合，形成新的增强器链</tspan></text></g><g ed:height="21" ed:width="250" ed:layout="rightmap" id="375" transform="matrix(1,0,0,1,1812,2216)" ed:parentid="366"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">e.将封装好的增强器链添加至ProxyFactory</tspan></text></g><g ed:height="21" ed:width="492" ed:layout="rightmap" id="376" transform="matrix(1,0,0,1,1812,2243)" ed:parentid="366"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">f.设置ProxyFactory的代理对象为TargetSource，TargetSource中包含了目标对象bean</tspan></text></g><g ed:height="21" ed:width="526" ed:layout="rightmap" id="377" transform="matrix(1,0,0,1,1812,2271)" ed:parentid="366"><path d="M0,0L526,0L526,21L0,21L0,0z" fill="#30c9f7"/><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">g.执行customizeProxyFactory(proxyFactory)空方法，留给子类实现对ProxyFactory进行定制</tspan></text></g><g ed:height="21" ed:width="296" ed:layout="rightmap" id="378" transform="matrix(1,0,0,1,1812,2298)" ed:parentid="366"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">h.代理工厂配置完后，冻结增强器配置，不允许修改</tspan></text></g><g ed:height="21" ed:width="247" ed:layout="rightmap" id="379" transform="matrix(1,0,0,1,2227,2051)" ed:parentid="370"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">和XML文件中proxy-target-class配置有关</tspan></text></g><g ed:height="21" ed:width="353" ed:layout="rightmap" id="380" transform="matrix(1,0,0,1,2227,2078)" ed:parentid="370"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">和beanDefinition中preserveTargetClass属性是否为true有关</tspan></text></g><g ed:height="21" ed:width="127" ed:layout="rightmap" id="381" transform="matrix(1,0,0,1,2227,2106)" ed:parentid="370"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">目标类是否包含接口</tspan></text></g><g ed:height="21" ed:width="341" ed:layout="rightmap" id="492" transform="matrix(1,0,0,1,1958,1446)" ed:parentid="337"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">A.首先处理引介增强器IntroductionAdvisor (流程参考AOP)</tspan></text></g><g ed:height="21" ed:width="141" ed:layout="rightmap" id="493" transform="matrix(1,0,0,1,1958,1666)" ed:parentid="337"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">B.然后处理普通增强器</tspan></text></g><g ed:height="21" ed:width="420" ed:layout="rightmap" id="497" transform="matrix(1,0,0,1,1958,1886)" ed:parentid="337"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">C.创建List容器eligibleAdvisors，用于保存过滤完匹配的增强器，并且有序</tspan></text></g><g ed:height="21" ed:width="352" ed:layout="rightmap" id="500" transform="matrix(1,0,0,1,2126,1473)" ed:parentid="493"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">a.重新遍历所有的增强器Advisor，如果是引介增强则直接略过</tspan></text></g><g ed:height="21" ed:width="338" ed:layout="rightmap" id="501" transform="matrix(1,0,0,1,2126,1666)" ed:parentid="493"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">b.如果仅是普通增强器，则验证是否匹配目标bean进行代理</tspan></text></g><g ed:height="21" ed:width="231" ed:layout="rightmap" id="502" transform="matrix(1,0,0,1,2126,1858)" ed:parentid="493"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">c.满足匹配，则添加至eligibleAdvisors</tspan></text></g><g ed:height="21" ed:width="202" ed:layout="rightmap" id="503" transform="matrix(1,0,0,1,1958,1913)" ed:parentid="337"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">D.返回所有有序的匹配的增强器链</tspan></text></g><g ed:height="21" ed:width="523" ed:layout="rightmap" id="504" transform="matrix(1,0,0,1,2491,1501)" ed:parentid="501"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">I.判断是否为PointcutAdvisor增强器，BeanFactoryTransactionAttributeSourceAdvisor满足</tspan></text></g><g ed:height="21" ed:width="636" ed:layout="rightmap" id="506" transform="matrix(1,0,0,1,2491,1528)" ed:parentid="501"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">II.获得对应的TransactionAttributeSourcePointcut对象，该对象能够返回AnnotationTransactionAttributeSource</tspan></text></g><g ed:height="21" ed:width="626" ed:layout="rightmap" id="510" transform="matrix(1,0,0,1,2491,1583)" ed:parentid="501"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">IV.获取MethodMatcher对象(其实还是TransactionAttributeSourcePointcut本身)，matches()方法用于匹配方法</tspan></text></g><g ed:height="21" ed:width="237" ed:layout="rightmap" id="511" transform="matrix(1,0,0,1,2491,1611)" ed:parentid="501"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">V.获取目标类以及目标类实现的所有接口</tspan></text></g><g ed:height="21" ed:width="628" ed:layout="rightmap" id="512" transform="matrix(1,0,0,1,2491,1734)" ed:parentid="501"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">VI.对这些类和接口中所有的方法进行遍历，利用TransactionAttributeSourcePointcut的match()方法进行匹配</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>@Override&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>public&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> boolean &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>matches&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>Method method&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> targetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 判断targetClass是否是TransactionalProxy的子类或者子接口，是的话直接返回false&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>TransactionalProxy&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>class&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isAssignableFrom&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>targetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>))&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>false&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 调用子类的getTransactionAttributeSource()方法&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 其实在构造BeanFactoryTransactionAttributeSourceAdvisor时进行了重写，返回BeanFactoryTransactionAttributeSourceAdvisor的annotationTransactionAttributeSource&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    TransactionAttributeSource tas &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getTransactionAttributeSource&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>();&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>tas &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>||&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> tas&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getTransactionAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>method&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> targetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * 确定此方法调用的事务属性&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * 如果未找到方法属性，则默认为类上配置的事务属性。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @param method the method for the current invocation (never {@code null})&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @param targetClass the target class for this invocation (may be {@code null})&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * @return a TransactionAttribute for this method, or {@code null} if the method&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * is not transactional&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>@Override&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>@Nullable&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>public&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> TransactionAttribute &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getTransactionAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>Method method&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> @Nullable Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> targetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 如果是Object中定义的方法，返回null&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>method&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getDeclaringClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Object&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>class&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 首先查看缓存中是否有对应的处理结果&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    Object cacheKey &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getCacheKey&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>method&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> targetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    Object cached &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>attributeCache&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>get&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>cacheKey&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>cached &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// Value will either be canonical value indicating there is no transaction attribute,&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// or an actual transaction attribute.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>cached &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>NULL_TRANSACTION_ATTRIBUTE&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>else&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>TransactionAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> cached&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>else&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// We need to work it out.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        TransactionAttribute txAttr &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>computeTransactionAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>method&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> targetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// Put it in the cache.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>txAttr &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 添加null缓存&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>attributeCache&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>put&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>cacheKey&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>NULL_TRANSACTION_ATTRIBUTE&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>else&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            String methodIdentification &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> ClassUtils&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getQualifiedMethodName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>method&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> targetClass&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>txAttr &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>instanceof&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>DefaultTransactionAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>((&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>DefaultTransactionAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> txAttr&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>).&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>setDescriptor&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>methodIdentification&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>logger&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isDebugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>())&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                logger&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>debug&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Adding transactional method '&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> methodIdentification &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;' with attribute: &amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> txAttr&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 添加缓存&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>this&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>attributeCache&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>put&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>cacheKey&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> txAttr&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> txAttr&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(602,4)"/></g></g><g ed:height="21" ed:width="629" ed:layout="rightmap" id="517" transform="matrix(1,0,0,1,2491,1556)" ed:parentid="501"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">III.TransactionAttributeSourcePointcut默认匹配所有的目标bean对应的类，故直接进一步查看匹配类中哪种方法</tspan></text></g><g ed:height="21" ed:width="270" ed:layout="rightmap" id="519" transform="matrix(1,0,0,1,3146,1638)" ed:parentid="512"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">i.如果是Object中定义的方法，直接认为不匹配</tspan></text></g><g ed:height="21" ed:width="235" ed:layout="rightmap" id="521" transform="matrix(1,0,0,1,3146,1734)" ed:parentid="512"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">ii.寻找到带有事务注解的方法或类或接口</tspan></text></g><g ed:height="21" ed:width="222" ed:layout="rightmap" id="523" transform="matrix(1,0,0,1,3408,1666)" ed:parentid="521"><text class="st6"><tspan style="white-space:pre" x="9" y="14.4">默认只允许public方法事务注解才生效</tspan></text></g><g ed:height="21" ed:width="319" ed:layout="rightmap" id="525" transform="matrix(1,0,0,1,3408,1693)" ed:parentid="521"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">方法可能是接口中的方法，先获取到对应实现类中的方法</tspan></text></g><g ed:height="21" ed:width="319" ed:layout="rightmap" id="527" transform="matrix(1,0,0,1,3408,1721)" ed:parentid="521"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">首先查看实现类中的方法上是否存在事务注解，有则返回</tspan></text></g><g ed:height="21" ed:width="415" ed:layout="rightmap" id="529" transform="matrix(1,0,0,1,3408,1748)" ed:parentid="521"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">其次查看方法所在类、父类和所有实现接口上是否存在事务声明，有则返回</tspan></text></g><g ed:height="21" ed:width="355" ed:layout="rightmap" id="531" transform="matrix(1,0,0,1,3408,1776)" ed:parentid="521"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">再其次查看实现接口中对应方法上是否存在事务注解，有则返回</tspan></text></g><g ed:height="21" ed:width="379" ed:layout="rightmap" id="533" transform="matrix(1,0,0,1,3408,1803)" ed:parentid="521"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">最后查看方法接口上是否存在事务声明，有则返回，无则表示不匹配</tspan></text></g><g ed:height="21" ed:width="695" ed:layout="rightmap" id="535" transform="matrix(1,0,0,1,3146,1831)" ed:parentid="512"><text class="st4"><tspan style="white-space:pre" x="10" y="14.4">iii.</tspan><tspan style="white-space:pre" class="st5">找到则对事务注解@Transactional中的信息进行提取封装为RuleBasedTransactionAttribute，并添加缓存供</tspan><tspan style="white-space:pre">4.1.6.3</tspan><tspan style="white-space:pre" class="st5">使用</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>protected&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> TransactionAttribute &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>parseTransactionAnnotation&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>AnnotationAttributes attributes&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    RuleBasedTransactionAttribute rbta &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>RuleBasedTransactionAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>();&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 解析propagation&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    Propagation propagation &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> attributes&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getEnum&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;propagation&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    rbta&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>setPropagationBehavior&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>propagation&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>value&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>());&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 解析isolation&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    Isolation isolation &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> attributes&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getEnum&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;isolation&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    rbta&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>setIsolationLevel&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>isolation&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>value&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>());&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 解析timeout&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    rbta&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>setTimeout&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>attributes&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getNumber&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;timeout&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>).&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>intValue&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>());&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 解析readOnly&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    rbta&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>setReadOnly&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>attributes&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getBoolean&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;readOnly&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>));&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 解析value&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    rbta&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>setQualifier&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>attributes&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getString&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;value&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>));&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    ArrayList &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> RollbackRuleAttribute &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> rollBackRules &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>ArrayList&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>();&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 解析rollbackFor&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>[]&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> rbf &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> attributes&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getClassArray&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;rollbackFor&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>for&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> rbRule &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>:&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> rbf&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        RollbackRuleAttribute rule &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>RollbackRuleAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>rbRule&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        rollBackRules&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>add&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>rule&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 解析rollbackForClassName&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    String&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>[]&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> rbfc &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> attributes&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getStringArray&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;rollbackForClassName&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>for&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>String rbRule&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>:&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> rbfc&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        RollbackRuleAttribute rule &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>RollbackRuleAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>rbRule&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        rollBackRules&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>add&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>rule&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 解析noRollbackFor&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>[]&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> nrbf &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> attributes&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getClassArray&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;noRollbackFor&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>for&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>Class &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;lt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>&amp;gt;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> rbRule &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>:&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> nrbf&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        NoRollbackRuleAttribute rule &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>NoRollbackRuleAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>rbRule&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        rollBackRules&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>add&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>rule&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 解析noRollbackForClassName&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    String&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>[]&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> nrbfc &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> attributes&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getStringArray&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;noRollbackForClassName&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>for&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>String rbRule&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>:&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> nrbfc&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        NoRollbackRuleAttribute rule &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>NoRollbackRuleAttribute&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>rbRule&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        rollBackRules&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>add&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>rule&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    rbta&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getRollbackRules&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>().&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>addAll&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>rollBackRules&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> rbta&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(669,4)"/></g></g><g ed:height="21" ed:width="194" ed:layout="rightmap" id="554" transform="matrix(1,0,0,1,414,2910)" ed:parentid="309"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.JDK动态代理的invoke()方法</tspan></text></g><g ed:height="21" ed:width="274" ed:layout="rightmap" id="555" transform="matrix(1,0,0,1,635,2387)" ed:parentid="554"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.1.获取到包含原始目标对象的TargetSource</tspan></text></g><g ed:height="21" ed:width="314" ed:layout="rightmap" id="556" transform="matrix(1,0,0,1,635,2415)" ed:parentid="554"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.2.对调用equals、hashcode等特殊方法的判断处理</tspan></text></g><g ed:height="21" ed:width="634" ed:layout="rightmap" id="558" transform="matrix(1,0,0,1,635,2442)" ed:parentid="554"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.3.根据TargetSource的getTarget()方法获取target目标对象，目标对象用于method.invoke(target，args)</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#4f4f4f; background-color:#ffffff;&quot;>proxy(代理对象)代理的不是target,而是TargetSource,这点非常重要!!!&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Arial';&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#4f4f4f; background-color:#ffffff;&quot;>通常情况下,一个proxy(代理对象)只能代理一个target,每次方法调用的目标也是唯一固定的target。但是,如果让proxy代理TargetSource,可以使得每次方法调用的target实例都不同(当然也可以相同,这取决于TargetSource实现)。这种机制使得方法调用变得灵活,可以扩展出很多高级功能,如:target pool(目标对象池)、hot swap(运行时目标对象热替换),等等。&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(608,4)"/></g></g><g ed:height="21" ed:width="367" ed:layout="rightmap" id="559" transform="matrix(1,0,0,1,635,2538)" ed:parentid="554"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.4.获取该方法 (invoke方法中的形参method) 对应的拦截器链</tspan></text></g><g ed:height="21" ed:width="301" ed:layout="rightmap" id="560" transform="matrix(1,0,0,1,1588,2497)" ed:parentid="567"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">a.获取之前解析出来的对应目标bean类型的增强器链</tspan></text></g><g ed:height="21" ed:width="555" ed:layout="rightmap" id="561" transform="matrix(1,0,0,1,1588,2525)" ed:parentid="567"><text class="st6"><tspan style="white-space:pre" x="10" y="14.4">b.</tspan><tspan style="white-space:pre" class="st5">遍历所有的增强器，判断该方法是否经过@Transactional注解标注 (判断逻辑和</tspan><tspan style="white-space:pre">3.2.2.4步骤</tspan><tspan style="white-space:pre" class="st5">中一致)</tspan></text></g><g ed:height="21" ed:width="281" ed:layout="rightmap" id="562" transform="matrix(1,0,0,1,1029,2607)" ed:parentid="559"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.4.3.将MethodInterceptor拦截器链添加缓存</tspan></text></g><g ed:height="21" ed:width="644" ed:layout="rightmap" id="564" transform="matrix(1,0,0,1,635,2635)" ed:parentid="554"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.5.将拦截器链封装在ReflectiveMethodInvocation的interceptorsAndDynamicMethodMatchers列表属性中</tspan></text><g ed:hyperlink="[&#xa;    {&#xa;        &quot;desc&quot;: &quot;ReflectiveMethodInvocation&quot;,&#xa;        &quot;link&quot;: &quot;https://img-blog.csdn.net/20181021165821863&quot;&#xa;    }&#xa;]&#xa;"><use xlink:href="#hyperlink" transform="translate(618,4)"/></g></g><g ed:height="21" ed:width="536" ed:layout="rightmap" id="565" transform="matrix(1,0,0,1,635,3033)" ed:parentid="554"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.6.执行拦截器链中每个拦截器的invoke方法，主要研究TransactionInterceptor的invoke方法</tspan></text></g><g ed:height="21" ed:width="242" ed:layout="rightmap" id="566" transform="matrix(1,0,0,1,1029,2470)" ed:parentid="559"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.4.1.从缓存中获取当前方法的拦截器链</tspan></text></g><g ed:height="21" ed:width="532" ed:layout="rightmap" id="567" transform="matrix(1,0,0,1,1029,2538)" ed:parentid="559"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.4.2.若缓存未命中，则调用getInterceptorsAndDynamicInterceptionAdvice()获取拦截器链</tspan></text></g><g ed:height="21" ed:width="603" ed:layout="rightmap" id="568" transform="matrix(1,0,0,1,1588,2552)" ed:parentid="567"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">c.将BeanFactoryTransactionAttributeSourceAdvisor中的TransactionInterceptor提取出来添加至拦截器链</tspan></text></g><g ed:height="21" ed:width="324" ed:layout="rightmap" id="569" transform="matrix(1,0,0,1,1588,2580)" ed:parentid="567"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">d.返回MethodInterceptor拦截器数组，也就是拦截器链</tspan></text></g><g ed:height="21" ed:width="172" ed:layout="rightmap" id="570" transform="matrix(1,0,0,1,635,3432)" ed:parentid="554"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.7.返回拦截器链执行结果</tspan></text></g><g ed:height="21" ed:width="867" ed:layout="rightmap" id="575" transform="matrix(1,0,0,1,1198,2662)" ed:parentid="565"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.6.1.获取对应method配置的事务属性，事务属性保存在AnnotationTransactionAttributeSource的attributeCache&lt;Object, TransactionAttribute>缓存中</tspan></text></g><g ed:height="21" ed:width="545" ed:layout="rightmap" id="577" transform="matrix(1,0,0,1,1198,2690)" ed:parentid="565"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.6.2.获取beanFactory中配置的transactionManager的实例DataSourceTransactionManager</tspan></text></g><g ed:height="21" ed:width="386" ed:layout="rightmap" id="579" transform="matrix(1,0,0,1,1198,3061)" ed:parentid="565"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">4.1.6.3.对不同的事务处理方式使用不同的逻辑，包括声明式和编程式</tspan></text></g><g ed:height="21" ed:width="79" ed:layout="rightmap" id="585" transform="matrix(1,0,0,1,1611,3047)" ed:parentid="579"><path d="M0,0L79,0L79,21L0,21L0,0z" fill="#f96628"/><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">声明式事务</tspan></text></g><g ed:height="21" ed:width="139" ed:layout="rightmap" id="587" transform="matrix(1,0,0,1,1611,3405)" ed:parentid="579"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">编程式事务 (暂不研究)</tspan></text></g><g ed:height="21" ed:width="386" ed:layout="rightmap" id="591" transform="matrix(1,0,0,1,1717,2951)" ed:parentid="585"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">a.创建TransactionInfo，在目标方法执行前获取事务并收集事务信息</tspan></text></g><g ed:height="21" ed:width="249" ed:layout="rightmap" id="593" transform="matrix(1,0,0,1,1717,3212)" ed:parentid="585"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">b.执行目标方法，也就是未增强的原来方法</tspan></text></g><g ed:height="21" ed:width="259" ed:layout="rightmap" id="595" transform="matrix(1,0,0,1,1717,3253)" ed:parentid="585"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">c.当执行目标方法出现错误进行异常回滚处理</tspan></text></g><g ed:height="21" ed:width="443" ed:layout="rightmap" id="597" transform="matrix(1,0,0,1,1717,3295)" ed:parentid="585"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">d.无论b、c哪一个执行成功，都进行清除信息步骤，主要就是将旧事务设置回来</tspan></text></g><g ed:height="21" ed:width="80" ed:layout="rightmap" id="599" transform="matrix(1,0,0,1,1717,3350)" ed:parentid="585"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">e.提交事务</tspan></text></g><g ed:height="21" ed:width="860" ed:layout="rightmap" id="601" transform="matrix(1,0,0,1,2130,2717)" ed:parentid="591"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">I.使用DelegatingTransactionAttribute封装包含事务属性的RuleBasedTransactionAttribute对象，将增强方法的标识(全限定类名+方法)作为事务属性的名称</tspan></text></g><g ed:height="21" ed:width="207" ed:layout="rightmap" id="603" transform="matrix(1,0,0,1,2130,2951)" ed:parentid="591"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">II.获取事务状态TransactionStatus</tspan></text></g><g ed:height="21" ed:width="670" ed:layout="rightmap" id="605" transform="matrix(1,0,0,1,2130,3185)" ed:parentid="591"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">III.构建事务信息TransactionInfo，包含了TransactionManager、TransactionAttribute以及TransactionStatus实例信息</tspan></text></g><g ed:height="21" ed:width="1057" ed:layout="rightmap" id="607" transform="matrix(1,0,0,1,2003,3240)" ed:parentid="595"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">回滚条件：对事务注解中配置的回滚规则进行遍历，如果符合规则，则返回 true，即需要回滚。默认情况下Spring中的事务异常处理机制只对RuntimeException和Error两种情况会进行回滚处理。</tspan></text></g><g ed:height="21" ed:width="1243" ed:layout="rightmap" id="609" transform="matrix(1,0,0,1,2003,3267)" ed:parentid="595"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">回滚处理：检查如果有保存点，直接回滚到保存点；如果没有保存点，但当前事务为独立的新事务，则可以直接回滚。前两种主要是嵌入式事务，如果当前事务不是独立的事务，那么只能标记状态，等到事务链执行完毕后统一回滚。</tspan></text></g><g ed:height="21" ed:width="76" ed:layout="rightmap" id="613" transform="matrix(1,0,0,1,2364,2772)" ed:parentid="603"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">i.获取事务</tspan></text></g><g ed:height="21" ed:width="760" ed:layout="rightmap" id="617" transform="matrix(1,0,0,1,2364,2896)" ed:parentid="603"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">ii.判断当前线程是否存在事务，判断依据为当前线程记录的数据库连接不为空且连接(connectionHolder)中的transactionAdvice属性不为空</tspan></text></g><g ed:height="21" ed:width="542" ed:layout="rightmap" id="619" transform="matrix(1,0,0,1,2364,2992)" ed:parentid="603"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">iii.事务超时设置验证，当我们在设置超时属性时，设置的值小于 -1，则认为是无效的值，抛出异常</tspan></text></g><g ed:height="21" ed:width="238" ed:layout="rightmap" id="621" transform="matrix(1,0,0,1,2364,3088)" ed:parentid="603"><text class="st3"><tspan style="white-space:pre" x="10" y="14.4">iv.不同事务传播行为采取不同的逻辑处理</tspan></text></g><g ed:height="21" ed:width="215" ed:layout="rightmap" id="625" transform="matrix(1,0,0,1,2467,2745)" ed:parentid="613"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">创建DataSourceTransactionObject</tspan></text></g><g ed:height="21" ed:width="479" ed:layout="rightmap" id="627" transform="matrix(1,0,0,1,2467,2772)" ed:parentid="613"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">如果事务属性配置允许嵌入式事务，则会在DataSourceTransactionObject设置保存点</tspan></text></g><g ed:height="21" ed:width="347" ed:layout="rightmap" id="629" transform="matrix(1,0,0,1,2467,2800)" ed:parentid="613"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">在DataSourceTransactionObject保存当前线程的数据库连接</tspan></text></g><g ed:height="21" ed:width="280" ed:layout="rightmap" id="631" transform="matrix(1,0,0,1,3151,2882)" ed:parentid="617"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">如果当前存在事务，按照传播行为不同的处理</tspan></text><g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>/**&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * 已经存在的事务的基础上进行处理&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> * Create a TransactionStatus for an existing transaction.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;> */&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>private&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> TransactionStatus &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>handleExistingTransaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    TransactionDefinition definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Object transaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> boolean debugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>throws TransactionException &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// NEVER不支持事务，只有在没有事务的环境中才能运行(运行到这里说明有事务，抛出异常)&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getPropagationBehavior&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> TransactionDefinition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>PROPAGATION_NEVER&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>throw&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>IllegalTransactionStateException&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Existing transaction found for transaction marked with propagation 'never'&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// NOT_SUPPORTED不支持事务，当前事务已经存在，会挂起存在的事务，直至该方法结束后恢复存在的事务&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getPropagationBehavior&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> TransactionDefinition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>PROPAGATION_NOT_SUPPORTED&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>debugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            logger&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>debug&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Suspending current transaction&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        Object suspendedResources &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>suspend&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>transaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 挂起&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        boolean newSynchronization &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getTransactionSynchronization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>SYNCHRONIZATION_ALWAYS&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>prepareTransactionStatus&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>false&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> newSynchronization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> debugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> suspendedResources&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// REQUIRES_NEW开启新的事务中运行，出错了全部回滚&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getPropagationBehavior&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> TransactionDefinition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>PROPAGATION_REQUIRES_NEW&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>debugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            logger&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>debug&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Suspending current transaction, creating new transaction with name [&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;]&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        SuspendedResourcesHolder suspendedResources &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>suspend&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>transaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 新事务的建立&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>try&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            boolean newSynchronization &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getTransactionSynchronization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>SYNCHRONIZATION_NEVER&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            DefaultTransactionStatus status &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>newTransactionStatus&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> transaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>true&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> newSynchronization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> debugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> suspendedResources&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>doBegin&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>transaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>prepareSynchronization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>status&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> status&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>catch&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>RuntimeException&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>|&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> Error beginEx&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>resumeAfterBeginException&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>transaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> suspendedResources&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> beginEx&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>throw&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> beginEx&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// NESTED和REQUIRES_NEW有点像，但是如果出错只会回滚新开启的小事务，别的不影响&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getPropagationBehavior&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> TransactionDefinition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>PROPAGATION_NESTED&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isNestedTransactionAllowed&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>())&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>throw&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>NestedTransactionNotSupportedException&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Transaction manager does not allow nested transactions by default - &amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;specify 'nestedTransactionAllowed' property with value 'true'&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>debugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            logger&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>debug&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Creating nested transaction with name [&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getName&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;]&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>useSavepointForNestedTransaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>())&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// Create savepoint within existing Spring-managed transaction,&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// through the SavepointManager API implemented by TransactionStatus.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// Usually uses JDBC 3.0 savepoints. Never activates Spring synchronization.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            DefaultTransactionStatus status &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>prepareTransactionStatus&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> transaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>false&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>false&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> debugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 如果没有可以使用保存点的方式控制事务回滚，那么在嵌入事务的建立初始新建保存点&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            status&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>createAndHoldSavepoint&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>();&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> status&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>else&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// Nested transaction through nested begin and commit/rollback calls.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// Usually only for JTA: Spring synchronization might get activated here&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// in case of a pre-existing JTA transaction.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// 有些情况是不能使用保存点操作，比如JTA，那么就建立新事务&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            boolean newSynchronization &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getTransactionSynchronization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>SYNCHRONIZATION_NEVER&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            DefaultTransactionStatus status &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>newTransactionStatus&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> transaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>true&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> newSynchronization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> debugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>doBegin&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>transaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>prepareSynchronization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>status&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> status&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'宋体'; color:#5f6364;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#7d8b99;&quot;>// Assumably PROPAGATION_SUPPORTS or PROPAGATION_REQUIRED.&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>debugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        logger&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>debug&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Participating in existing transaction&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isValidateExistingTransaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>())&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getIsolationLevel&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> TransactionDefinition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>ISOLATION_DEFAULT&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            Integer currentIsolationLevel &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> TransactionSynchronizationManager&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getCurrentTransactionIsolationLevel&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>();&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>currentIsolationLevel &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>==&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>||&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> currentIsolationLevel &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getIsolationLevel&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>())&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                Constants isoConstants &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> DefaultTransactionDefinition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>constants&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>throw&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>IllegalTransactionStateException&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Participating transaction with definition [&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                    definition &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;] specifies isolation level which is incompatible with existing transaction: &amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>currentIsolationLevel &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>?&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                        isoConstants&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>toCode&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>currentIsolationLevel&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> DefaultTransactionDefinition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>PREFIX_ISOLATION&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>)&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>:&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;(unknown)&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>));&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isReadOnly&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>())&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>if&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>TransactionSynchronizationManager&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>.&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>isCurrentTransactionReadOnly&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>())&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>{&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>throw&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>new&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>IllegalTransactionStateException&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;Participating transaction with definition [&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>                    definition &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>+&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>&amp;quot;] is not marked as read-only but existing transaction is&amp;quot;&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>            &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>        &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    boolean newSynchronization &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>getTransactionSynchronization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>()&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#a67f59; background-color:#ffffff;&quot;>!=&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>SYNCHRONIZATION_NEVER&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>return&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#2f9c0a;&quot;>prepareTransactionStatus&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>(&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;>definition&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> transaction&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#c92c2c;&quot;>false&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> newSynchronization&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> debugEnabled&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>,&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#000000; background-color:#fdfdfd;&quot;> &lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#1990b8;&quot;>null&lt;/span>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>);&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'宋体'; color:#5f6364;&quot;>}&lt;/span>&lt;/p>&lt;/body>"><use xlink:href="#note" transform="translate(254,4)"/></g></g><g ed:height="21" ed:width="148" ed:layout="rightmap" id="633" transform="matrix(1,0,0,1,3151,2965)" ed:parentid="617"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">不存在，继续往下第iii步</tspan></text></g><g ed:height="21" ed:width="482" ed:layout="rightmap" id="635" transform="matrix(1,0,0,1,2629,3020)" ed:parentid="621"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">执行到这说明当前线程不存在事务，但是传播行为如果声明为MANDATORY则抛出异常</tspan></text></g><g ed:height="21" ed:width="390" ed:layout="rightmap" id="637" transform="matrix(1,0,0,1,2629,3075)" ed:parentid="621"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">传播行为是REQUIRED、REQUIRES_NEW、NESTED都需要新建事务</tspan></text></g><g ed:height="21" ed:width="419" ed:layout="rightmap" id="639" transform="matrix(1,0,0,1,2629,3143)" ed:parentid="621"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">其他传播行为SUPPORTS、NOT_SUPPORTED、NEVER不需要创建事务	</tspan></text></g><g ed:height="21" ed:width="210" ed:layout="rightmap" id="641" transform="matrix(1,0,0,1,3046,3047)" ed:parentid="637"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">构造DefaultTransactionStatus实例</tspan></text></g><g ed:height="21" ed:width="676" ed:layout="rightmap" id="643" transform="matrix(1,0,0,1,3046,3075)" ed:parentid="637"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">完善DataSourceTransactionObject，包括设置ConnectionHolder、隔离级别、timeout。如果是新连接，绑定到当前线程</tspan></text></g><g ed:height="21" ed:width="637" ed:layout="rightmap" id="645" transform="matrix(1,0,0,1,3046,3102)" ed:parentid="637"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">将事务信息DefaultTransactionStatus实例记录在当前线程中，主要设置在TransactionSynchronizationManager中</tspan></text></g><g ed:height="21" ed:width="499" ed:layout="rightmap" id="647" transform="matrix(1,0,0,1,3458,2827)" ed:parentid="631"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">NEVER不支持事务，只有在没有事务的环境中才能运行(运行到这里说明有事务，抛出异常)</tspan></text></g><g ed:height="21" ed:width="590" ed:layout="rightmap" id="649" transform="matrix(1,0,0,1,3458,2855)" ed:parentid="631"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">NOT_SUPPORTED不支持事务，当前事务已经存在，会挂起存在的事务，直至该方法结束后恢复存在的事务</tspan></text></g><g ed:height="21" ed:width="317" ed:layout="rightmap" id="651" transform="matrix(1,0,0,1,3458,2882)" ed:parentid="631"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">REQUIRES_NEW开启新的事务中运行，出错了全部回滚</tspan></text></g><g ed:height="21" ed:width="496" ed:layout="rightmap" id="653" transform="matrix(1,0,0,1,3458,2910)" ed:parentid="631"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">NESTED和REQUIRES_NEW有点像，但是如果出错只会回滚新开启的小事务，别的不影响</tspan></text></g><g ed:height="21" ed:width="307" ed:layout="rightmap" id="655" transform="matrix(1,0,0,1,3075,3130)" ed:parentid="639"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">忽略用户配置的非默认隔离级别，因为当前不存在事务</tspan></text></g><g ed:height="21" ed:width="306" ed:layout="rightmap" id="657" transform="matrix(1,0,0,1,3075,3157)" ed:parentid="639"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">构造DefaultTransactionStatus实例，并没有开启事务</tspan></text></g><g ed:height="21" ed:width="223" ed:layout="rightmap" id="661" transform="matrix(1,0,0,1,1824,3322)" ed:parentid="599"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">如果当前事务被标记回滚，则进行回滚</tspan></text></g><g ed:height="21" ed:width="415" ed:layout="rightmap" id="663" transform="matrix(1,0,0,1,1824,3350)" ed:parentid="599"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">如果当前事务没有标记回滚但是全局事务也没有回滚标记，也需要进行回滚</tspan></text></g><g ed:height="21" ed:width="115" ed:layout="rightmap" id="665" transform="matrix(1,0,0,1,1824,3377)" ed:parentid="599"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">否则进行事务提交</tspan></text></g><g ed:height="21" ed:width="335" ed:layout="rightmap" id="667" transform="matrix(1,0,0,1,3458,2937)" ed:parentid="631"><text class="st3"><tspan style="white-space:pre" x="9" y="14.4">SUPPORTS和REQUIRED在已经存在的当前事务中进行操作</tspan></text></g><symbol id="plus"><path d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6z" fill="url(#lg1)"/><path stroke="#46a000" d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6zM3,6L9,6M6,3L6,9" fill="none" stroke-width="0.7"/></symbol><symbol id="minus"><path d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6z" fill="url(#lg1)"/><path stroke="#46a000" d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6zM3,6L9,6" fill="none" stroke-width="0.7"/></symbol><g ed:togtopicid="101" transform="translate(201,77)"><use xlink:href="#minus"/></g><g ed:togtopicid="102" transform="translate(386,600)"><use xlink:href="#minus"/></g><g ed:togtopicid="104" transform="translate(682,234)"><use xlink:href="#minus"/></g><g ed:togtopicid="112" transform="translate(890,262)"><use xlink:href="#minus"/></g><g ed:togtopicid="116" transform="translate(1195,234)"><use xlink:href="#minus"/></g><g ed:togtopicid="118" transform="translate(1094,334)"><use xlink:href="#minus"/></g><g ed:togtopicid="152" transform="translate(563,507)"><use xlink:href="#minus"/></g><g ed:togtopicid="159" transform="translate(956,458)"><use xlink:href="#minus"/></g><g ed:togtopicid="182" transform="translate(1035,562)"><use xlink:href="#minus"/></g><g ed:togtopicid="191" transform="translate(796,681)"><use xlink:href="#minus"/></g><g ed:togtopicid="201" transform="translate(539,818)"><use xlink:href="#minus"/></g><g ed:togtopicid="203" transform="translate(563,997)"><use xlink:href="#minus"/></g><g ed:togtopicid="207" transform="translate(871,818)"><use xlink:href="#minus"/></g><g ed:togtopicid="227" transform="translate(768,1038)"><use xlink:href="#minus"/></g><g ed:togtopicid="246" transform="translate(368,1196)"><use xlink:href="#minus"/></g><g ed:togtopicid="248" transform="translate(698,1155)"><use xlink:href="#minus"/></g><g ed:togtopicid="256" transform="translate(745,1251)"><use xlink:href="#minus"/></g><g ed:togtopicid="273" transform="translate(393,1821)"><use xlink:href="#minus"/></g><g ed:togtopicid="309" transform="translate(388,2914)"><use xlink:href="#minus"/></g><g ed:togtopicid="327" transform="translate(707,1835)"><use xlink:href="#minus"/></g><g ed:togtopicid="329" transform="translate(1007,1835)"><use xlink:href="#minus"/></g><g ed:togtopicid="333" transform="translate(1617,1684)"><use xlink:href="#minus"/></g><g ed:togtopicid="337" transform="translate(1932,1684)"><use xlink:href="#minus"/></g><g ed:togtopicid="344" transform="translate(1605,2165)"><use xlink:href="#minus"/></g><g ed:togtopicid="366" transform="translate(1786,2151)"><use xlink:href="#minus"/></g><g ed:togtopicid="370" transform="translate(2201,2083)"><use xlink:href="#minus"/></g><g ed:togtopicid="371" transform="translate(1978,2165)"><use xlink:href="#minus"/></g><g ed:togtopicid="493" transform="translate(2100,1670)"><use xlink:href="#minus"/></g><g ed:togtopicid="501" transform="translate(2465,1670)"><use xlink:href="#minus"/></g><g ed:togtopicid="512" transform="translate(3120,1739)"><use xlink:href="#minus"/></g><g ed:togtopicid="521" transform="translate(3382,1739)"><use xlink:href="#minus"/></g><g ed:togtopicid="554" transform="translate(609,2914)"><use xlink:href="#minus"/></g><g ed:togtopicid="559" transform="translate(1003,2543)"><use xlink:href="#minus"/></g><g ed:togtopicid="565" transform="translate(1172,3038)"><use xlink:href="#minus"/></g><g ed:togtopicid="567" transform="translate(1562,2543)"><use xlink:href="#minus"/></g><g ed:togtopicid="579" transform="translate(1585,3065)"><use xlink:href="#minus"/></g><g ed:togtopicid="585" transform="translate(1691,3052)"><use xlink:href="#minus"/></g><g ed:togtopicid="591" transform="translate(2104,2955)"><use xlink:href="#minus"/></g><g ed:togtopicid="595" transform="translate(1977,3258)"><use xlink:href="#minus"/></g><g ed:togtopicid="599" transform="translate(1798,3354)"><use xlink:href="#minus"/></g><g ed:togtopicid="603" transform="translate(2338,2955)"><use xlink:href="#minus"/></g><g ed:togtopicid="613" transform="translate(2441,2777)"><use xlink:href="#minus"/></g><g ed:togtopicid="617" transform="translate(3125,2900)"><use xlink:href="#minus"/></g><g ed:togtopicid="621" transform="translate(2603,3093)"><use xlink:href="#minus"/></g><g ed:togtopicid="631" transform="translate(3432,2887)"><use xlink:href="#minus"/></g><g ed:togtopicid="637" transform="translate(3020,3079)"><use xlink:href="#minus"/></g><g ed:togtopicid="639" transform="translate(3049,3148)"><use xlink:href="#minus"/></g></svg>